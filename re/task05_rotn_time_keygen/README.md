# Task 05: ROT-N (time-based) + Keygen

## üìã –û–ø–∏—Å –∑–∞–≤–¥–∞–Ω–Ω—è

–ó—Å—É–≤ –∑–º—ñ–Ω—é—î—Ç—å—Å—è –ö–û–ñ–ù–û–á –°–ï–ö–£–ù–î–ò! `N = time() % 20`. –ü–æ—Ç—Ä—ñ–±–µ–Ω **–∫–µ–π–≥–µ–Ω**, —è–∫–∏–π –≥–µ–Ω–µ—Ä—É—î –ø—Ä–∞–≤–∏–ª—å–Ω–∏–π —Å–µ—Ä—ñ–π–Ω–∏–∫ –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ.

**–†—ñ–≤–µ–Ω—å:** ‚≠ê‚≠ê‚≠ê‚≠ê –°–∫–ª–∞–¥–Ω–∏–π | **–ö–∞—Ç–µ–≥–æ—Ä—ñ—è:** Time-based algorithms, Keygen development

## üéØ –ù–∞–≤—á–∞–ª—å–Ω–∞ –º–µ—Ç–∞

- –†–æ–∑—É–º—ñ—Ç–∏ time-based –∞–ª–≥–æ—Ä–∏—Ç–º–∏
- –ü–∏—Å–∞—Ç–∏ –∫–µ–π–≥–µ–Ω–∏ (–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∏ –∫–ª—é—á—ñ–≤)
- –°–∏–Ω—Ö—Ä–æ–Ω—ñ–∑—É–≤–∞—Ç–∏ —á–∞—Å –º—ñ–∂ –∫–µ–π–≥–µ–Ω–æ–º —Ç–∞ –ø—Ä–æ–≥—Ä–∞–º–æ—é
- –ê–Ω–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –∑–∞–ª–µ–∂–Ω—ñ—Å—Ç—å –≤—ñ–¥ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ —á–∞—Å—É

## üìö –©–æ –∑–º—ñ–Ω–∏–ª–æ—Å—è?

**Task 04:** `N = strlen(name) % 26` - –∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ —ñ–º–µ–Ω—ñ
**Task 05:** `N = time() % 20` - –∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ –ß–ê–°–£!

**–ü—Ä–æ–±–ª–µ–º–∞:** –°–µ—Ä—ñ–π–Ω–∏–∫ –¥—ñ–π—Å–Ω–∏–π –ª–∏—à–µ 1 —Å–µ–∫—É–Ω–¥—É!

```
13:37:00 ‚Üí time()=1698160620 ‚Üí N=0  ‚Üí serial="Alice"
13:37:01 ‚Üí time()=1698160621 ‚Üí N=1  ‚Üí serial="Bmjdf"
13:37:02 ‚Üí time()=1698160622 ‚Üí N=2  ‚Üí serial="Cnkeg"
```

## üõ†Ô∏è –ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞

```bash
cd task05_rotn_time_keygen
./build.sh
```

## üîç –ü–æ–∫—Ä–æ–∫–æ–≤–µ —Ä—ñ—à–µ–Ω–Ω—è

### –ö—Ä–æ–∫ 1: –°–ø—Ä–æ–±–∞ —Å—Ç–∞—Ç–∏—á–Ω–æ–≥–æ —Å–µ—Ä—ñ–π–Ω–∏–∫–∞ (FAIL)

```bash
./build/re105 Alice Fqnhj
# nope (–ø—Ä–∞—Ü—é–≤–∞–ª–æ –± —è–∫–±–∏ N=5, –∞–ª–µ –∑–∞—Ä–∞–∑ —ñ–Ω—à–∏–π —á–∞—Å!)
```

### –ö—Ä–æ–∫ 2: –ê–Ω–∞–ª—ñ–∑ —á–µ—Ä–µ–∑ Ghidra

–í—ñ–¥–∫—Ä–∏–≤–∞—î–º–æ `build/re105` —É Ghidra —Ç–∞ –∑–Ω–∞—Ö–æ–¥–∏–º–æ –≤ `main`:

```c
time_t t = time(NULL);        // ‚Üê –ü–æ—Ç–æ—á–Ω–∏–π —á–∞—Å (Unix timestamp)
int N = (int)(t % 20);         // ‚Üê –ó—Å—É–≤ –≤—ñ–¥ 0 –¥–æ 19
rot_apply(buffer, name, N);
```

**–ê–≥–∞!** –ó—Å—É–≤ –∑–º—ñ–Ω—é—î—Ç—å—Å—è –∫–æ–∂–Ω–æ—ó —Å–µ–∫—É–Ω–¥–∏!

### –ö—Ä–æ–∫ 3: –ù–∞–ø–∏—Å–∞–Ω–Ω—è –∫–µ–π–≥–µ–Ω–∞

#### –û—Å–Ω–æ–≤–∏ Python –¥–ª—è –Ω–æ–≤–∞—á–∫—ñ–≤

–Ø–∫—â–æ –≤–∏ –≤–ø–µ—Ä—à–µ –±–∞—á–∏—Ç–µ Python –∫–æ–¥, –æ—Å—å –±–∞–∑–æ–≤—ñ –ø–æ–Ω—è—Ç—Ç—è:

**–©–æ —Ç–∞–∫–µ Python?**
- –ú–æ–≤–∞ –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è –≤–∏—Å–æ–∫–æ–≥–æ —Ä—ñ–≤–Ω—è
- –ü—Ä–æ—Å—Ç–∏–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å, —á–∏—Ç–∞–±–µ–ª—å–Ω–∏–π –∫–æ–¥
- –ù–µ –ø–æ—Ç—Ä—ñ–±–Ω–∞ –∫–æ–º–ø—ñ–ª—è—Ü—ñ—è - —Å–∫—Ä–∏–ø—Ç–∏ –∑–∞–ø—É—Å–∫–∞—é—Ç—å—Å—è –Ω–∞–ø—Ä—è–º—É

**–Ø–∫ –∑–∞–ø—É—Å—Ç–∏—Ç–∏ Python —Å–∫—Ä–∏–ø—Ç:**
```bash
python3 script.py          # –ó–∞–ø—É—Å—Ç–∏—Ç–∏ —Å–∫—Ä–∏–ø—Ç
python3 script.py Alice    # –ó–∞–ø—É—Å—Ç–∏—Ç–∏ –∑ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–º "Alice"
```

**–ë–∞–∑–æ–≤–∏–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å Python:**
```python
# –¶–µ –∫–æ–º–µ–Ω—Ç–∞—Ä (—ñ–≥–Ω–æ—Ä—É—î—Ç—å—Å—è)

x = 5                      # –ó–º—ñ–Ω–Ω–∞ (–Ω–µ –ø–æ—Ç—Ä—ñ–±–µ–Ω —Ç–∏–ø!)
text = "Hello"             # –†—è–¥–æ–∫ –≤ –ª–∞–ø–∫–∞—Ö

def my_function(param):    # –û–≥–æ–ª–æ—à–µ–Ω–Ω—è —Ñ—É–Ω–∫—Ü—ñ—ó
    result = param + 1     # –í—ñ–¥—Å—Ç—É–ø–∏ –í–ê–ñ–õ–ò–í–Ü (4 –ø—Ä–æ–±—ñ–ª–∏)
    return result          # –ü–æ–≤–µ—Ä–Ω—É—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è

if x > 3:                  # –£–º–æ–≤–∞
    print("–ë—ñ–ª—å—à–µ 3")      # –í–∏–≤—ñ–¥ –Ω–∞ –µ–∫—Ä–∞–Ω
else:
    print("–ú–µ–Ω—à–µ –∞–±–æ 3")

for char in text:          # –¶–∏–∫–ª –ø–æ —Å–∏–º–≤–æ–ª–∞—Ö
    print(char)            # H, e, l, l, o

# –†–æ–±–æ—Ç–∞ –∑ —Å–∏–º–≤–æ–ª–∞–º–∏
ord('A')                   # ‚Üí 65 (ASCII –∫–æ–¥ –±—É–∫–≤–∏ A)
chr(65)                    # ‚Üí 'A' (–±—É–∫–≤–∞ –∑ ASCII –∫–æ–¥–∞)
```

**–°–ø–∏—Å–∫–∏ (lists):**
```python
my_list = []               # –ü–æ—Ä–æ–∂–Ω—ñ–π —Å–ø–∏—Å–æ–∫
my_list.append('A')        # –î–æ–¥–∞—Ç–∏ –µ–ª–µ–º–µ–Ω—Ç
my_list.append('B')        # my_list —Ç–µ–ø–µ—Ä ['A', 'B']
''.join(my_list)           # ‚Üí 'AB' (–æ–±'—î–¥–Ω–∞—Ç–∏ –≤ —Ä—è–¥–æ–∫)
```

**–ú–æ–¥—É–ª—ñ (import):**
```python
import time                # –Ü–º–ø–æ—Ä—Ç—É–≤–∞—Ç–∏ –º–æ–¥—É–ª—å time
t = time.time()            # –í–∏–∫–ª–∏–∫–∞—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ—é –∑ –º–æ–¥—É–ª—è
```

–°—Ç–≤–æ—Ä—é—î–º–æ `solver/keygen.py`:

```python
#!/usr/bin/env python3
import time

def rot_n(text, n):
    """ROT-N —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è"""
    result = []
    for char in text:
        if 'a' <= char <= 'z':
            result.append(chr((ord(char) - ord('a') + n) % 26 + ord('a')))
        elif 'A' <= char <= 'Z':
            result.append(chr((ord(char) - ord('A') + n) % 26 + ord('A')))
        else:
            result.append(char)
    return ''.join(result)

def generate_serial(name):
    """–ì–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ —Å–µ—Ä—ñ–π–Ω–∏–∫ –Ω–∞ –æ—Å–Ω–æ–≤—ñ –ø–æ—Ç–æ—á–Ω–æ–≥–æ —á–∞—Å—É"""
    t = int(time.time())      # –ü–æ—Ç–æ—á–Ω–∏–π Unix timestamp
    n = t % 20                 # –ó—Å—É–≤ –≤—ñ–¥ 0 –¥–æ 19
    serial = rot_n(name, n)
    return serial, n, t

if __name__ == "__main__":
    import sys

    if len(sys.argv) != 2:
        print(f"Usage: {sys.argv[0]} <name>")
        sys.exit(1)

    name = sys.argv[1]
    serial, n, t = generate_serial(name)

    print(f"[*] Current time: {t}")
    print(f"[*] N (shift): {n}")
    print(f"[+] Serial: {serial}")
    print()
    print(f"[!] Quick! Run immediately:")
    print(f"    ./build/re105 {name} {serial}")
```

#### –ü–æ—è—Å–Ω–µ–Ω–Ω—è –∫–æ–¥—É –ø–æ—Å—Ç—Ä–æ–∫–æ–≤–æ

–†–æ–∑–±–µ—Ä–µ–º–æ –∫–µ–π–≥–µ–Ω –¥–µ—Ç–∞–ª—å–Ω–æ –¥–ª—è —Ç–∏—Ö, —Ö—Ç–æ –Ω–µ –∑–Ω–∞–π–æ–º–∏–π –∑ Python:

```python
#!/usr/bin/env python3
# ‚Üë "shebang" - –∫–∞–∂–µ —Å–∏—Å—Ç–µ–º—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ python3 –¥–ª—è –∑–∞–ø—É—Å–∫—É

import time
# ‚Üë –Ü–º–ø–æ—Ä—Ç—É—î–º–æ –º–æ–¥—É–ª—å –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ —á–∞—Å–æ–º

def rot_n(text, n):
# ‚Üë –û–≥–æ–ª–æ—à—É—î–º–æ —Ñ—É–Ω–∫—Ü—ñ—é rot_n, —è–∫–∞ –ø—Ä–∏–π–º–∞—î —Ç–µ–∫—Å—Ç —ñ –∑—Å—É–≤ n

    result = []
    # ‚Üë –°—Ç–≤–æ—Ä—é—î–º–æ –ø–æ—Ä–æ–∂–Ω—ñ–π —Å–ø–∏—Å–æ–∫ –¥–ª—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É

    for char in text:
    # ‚Üë –¶–∏–∫–ª: –ø—Ä–æ—Ö–æ–¥–∏–º–æ –ø–æ –∫–æ–∂–Ω–æ–º—É —Å–∏–º–≤–æ–ª—É –≤ —Ç–µ–∫—Å—Ç—ñ

        if 'a' <= char <= 'z':
        # ‚Üë –Ø–∫—â–æ —Å–∏–º–≤–æ–ª - –º–∞–ª–µ–Ω—å–∫–∞ –ª—ñ—Ç–µ—Ä–∞ (a-z)

            result.append(chr((ord(char) - ord('a') + n) % 26 + ord('a')))
            # –†–æ–∑–±—ñ—Ä –≤–∏—Ä–∞–∑—É:
            # ord(char) - –æ—Ç—Ä–∏–º–∞—Ç–∏ ASCII –∫–æ–¥ —Å–∏–º–≤–æ–ª—É (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, 'a' ‚Üí 97)
            # ord('a') - ASCII –∫–æ–¥ 'a' (97)
            # ord(char) - ord('a') - –ø–æ–∑–∏—Ü—ñ—è –≤ –∞–ª—Ñ–∞–≤—ñ—Ç—ñ (0-25)
            # + n - –¥–æ–¥–∞—Ç–∏ –∑—Å—É–≤
            # % 26 - —è–∫—â–æ –≤–∏–π—à–ª–∏ –∑–∞ –º–µ–∂—ñ, –ø–æ–≤–µ—Ä–Ω—É—Ç–∏—Å—å –Ω–∞ –ø–æ—á–∞—Ç–æ–∫
            # + ord('a') - –ø–µ—Ä–µ—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–∞–∑–∞–¥ –≤ ASCII –∫–æ–¥
            # chr(...) - –ø–µ—Ä–µ—Ç–≤–æ—Ä–∏—Ç–∏ ASCII –∫–æ–¥ –Ω–∞–∑–∞–¥ –≤ —Å–∏–º–≤–æ–ª
            # result.append(...) - –¥–æ–¥–∞—Ç–∏ —Å–∏–º–≤–æ–ª –¥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É

        elif 'A' <= char <= 'Z':
        # ‚Üë –Ø–∫—â–æ —Å–∏–º–≤–æ–ª - –≤–µ–ª–∏–∫–∞ –ª—ñ—Ç–µ—Ä–∞ (A-Z)
            result.append(chr((ord(char) - ord('A') + n) % 26 + ord('A')))
            # –¢–µ —Å–∞–º–µ, –∞–ª–µ –¥–ª—è –≤–µ–ª–∏–∫–∏—Ö –ª—ñ—Ç–µ—Ä

        else:
        # ‚Üë –Ø–∫—â–æ –ù–ï –ª—ñ—Ç–µ—Ä–∞ (—Ü–∏—Ñ—Ä–∞, –ø—Ä–æ–±—ñ–ª, —Ç–æ—â–æ)
            result.append(char)
            # –ó–∞–ª–∏—à–∞—î–º–æ —Å–∏–º–≤–æ–ª –±–µ–∑ –∑–º—ñ–Ω

    return ''.join(result)
    # ‚Üë –û–±'—î–¥–Ω—É—î–º–æ —Å–ø–∏—Å–æ–∫ —Å–∏–º–≤–æ–ª—ñ–≤ —É —Ä—è–¥–æ–∫ —ñ –ø–æ–≤–µ—Ä—Ç–∞—î–º–æ

def generate_serial(name):
# ‚Üë –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó —Å–µ—Ä—ñ–π–Ω–∏–∫–∞

    t = int(time.time())
    # ‚Üë –û—Ç—Ä–∏–º–∞—Ç–∏ –ø–æ—Ç–æ—á–Ω–∏–π Unix timestamp (—Å–µ–∫—É–Ω–¥–∏ –∑ 1 —Å—ñ—á–Ω—è 1970)

    n = t % 20
    # ‚Üë –û–±—á–∏—Å–ª–∏—Ç–∏ –∑—Å—É–≤: –∑–∞–ª–∏—à–æ–∫ –≤—ñ–¥ –¥—ñ–ª–µ–Ω–Ω—è –Ω–∞ 20 (—Ä–µ–∑—É–ª—å—Ç–∞—Ç 0-19)

    serial = rot_n(name, n)
    # ‚Üë –ó–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏ ROT-N —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è –¥–æ —ñ–º–µ–Ω—ñ

    return serial, n, t
    # ‚Üë –ü–æ–≤–µ—Ä–Ω—É—Ç–∏ —Å–µ—Ä—ñ–π–Ω–∏–∫, –∑—Å—É–≤, —Ç–∞ —á–∞—Å (—Ç—Ä–∏ –∑–Ω–∞—á–µ–Ω–Ω—è –æ–¥—Ä–∞–∑—É!)

if __name__ == "__main__":
# ‚Üë –Ø–∫—â–æ —Å–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫–∞—î—Ç—å—Å—è –Ω–∞–ø—Ä—è–º—É (–Ω–µ —ñ–º–ø–æ—Ä—Ç—É—î—Ç—å—Å—è)

    import sys
    # ‚Üë –Ü–º–ø–æ—Ä—Ç—É—î–º–æ –º–æ–¥—É–ª—å –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏ –∫–æ–º–∞–Ω–¥–Ω–æ–≥–æ —Ä—è–¥–∫–∞

    if len(sys.argv) != 2:
    # ‚Üë –Ø–∫—â–æ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∞—Ä–≥—É–º–µ–Ω—Ç—ñ–≤ –ù–ï 2 (—Å–∫—Ä–∏–ø—Ç + —ñ–º'—è)
        print(f"Usage: {sys.argv[0]} <name>")
        # sys.argv[0] - –Ω–∞–∑–≤–∞ —Å–∫—Ä–∏–ø—Ç—É
        sys.exit(1)
        # –í–∏–π—Ç–∏ –∑ –∫–æ–¥–æ–º –ø–æ–º–∏–ª–∫–∏ 1

    name = sys.argv[1]
    # ‚Üë –û—Ç—Ä–∏–º–∞—Ç–∏ –ø–µ—Ä—à–∏–π –∞—Ä–≥—É–º–µ–Ω—Ç (—ñ–º'—è)

    serial, n, t = generate_serial(name)
    # ‚Üë –í–∏–∫–ª–∏–∫–∞—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ—é, —Ä–æ–∑–ø–∞–∫—É–≤–∞—Ç–∏ —Ç—Ä–∏ –ø–æ–≤–µ—Ä–Ω–µ–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è

    print(f"[*] Current time: {t}")
    # ‚Üë f"..." - f-string –¥–ª—è –ø—ñ–¥—Å—Ç–∞–Ω–æ–≤–∫–∏ –∑–º—ñ–Ω–Ω–∏—Ö
```

**–ü—Ä–∏–∫–ª–∞–¥ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è:**
```python
# –Ø–∫—â–æ —á–∞—Å = 1698160622, name = "Alice"
t = 1698160622
n = t % 20              # n = 2
serial = rot_n("Alice", 2)

# ROT-2 –¥–ª—è "Alice":
# A ‚Üí C, l ‚Üí n, i ‚Üí k, c ‚Üí e, e ‚Üí g
# –†–µ–∑—É–ª—å—Ç–∞—Ç: "Cnkeg"
```

### –ö—Ä–æ–∫ 4: –ó–∞–ø—É—Å–∫ –∫–µ–π–≥–µ–Ω–∞ —Ç–∞ –ø—Ä–æ–≥—Ä–∞–º–∏ –®–í–ò–î–ö–û

```bash
# –ì–µ–Ω–µ—Ä—É—î–º–æ —Å–µ—Ä—ñ–π–Ω–∏–∫
python3 solver/keygen.py Alice
# [+] Serial: Doljh

# –®–í–ò–î–ö–û –∫–æ–ø—ñ—é—î–º–æ —Ç–∞ –∑–∞–ø—É—Å–∫–∞—î–º–æ (–≤ —Ç—ñ–π –∂–µ —Å–µ–∫—É–Ω–¥—ñ!)
./build/re105 Alice Doljh
# FLAG{task5_ok_Alice}
```

**–í–∞–∂–ª–∏–≤–æ:** –ú—ñ–∂ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—î—é —Ç–∞ –∑–∞–ø—É—Å–∫–æ–º –º–∞—î –ø—Ä–æ–π—Ç–∏ <1 —Å–µ–∫—É–Ω–¥–∏!

### –ö—Ä–æ–∫ 5: –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—è (bash one-liner)

```bash
name="Alice" && ./build/re105 "$name" "$(python3 solver/keygen.py "$name" | grep Serial | awk '{print $3}')"
```

–ê–±–æ –ø–æ–≤–Ω—ñ—Å—Ç—é –≤ Python:

```python
#!/usr/bin/env python3
import subprocess, time, sys

def rot_n(text, n):
    result = []
    for char in text:
        if 'a' <= char <= 'z':
            result.append(chr((ord(char) - ord('a') + n) % 26 + ord('a')))
        elif 'A' <= char <= 'Z':
            result.append(chr((ord(char) - ord('A') + n) % 26 + ord('A')))
        else:
            result.append(char)
    return ''.join(result)

name = sys.argv[1] if len(sys.argv) > 1 else "Alice"
n = int(time.time()) % 20
serial = rot_n(name, n)

# –ó–∞–ø—É—Å–∫–∞—î–º–æ –ø—Ä–æ–≥—Ä–∞–º—É –æ–¥—Ä–∞–∑—É
result = subprocess.run(
    ['./build/re105', name, serial],
    capture_output=True, text=True
)
print(result.stdout)
```

## üéì Time-based Security

### –ß–æ–º—É —Ü–µ —Ü—ñ–∫–∞–≤–æ?

**Real-world –∞–Ω–∞–ª–æ–≥–∏:**
- TOTP (Time-based One-Time Password) - Google Authenticator
- –õ—ñ—Ü–µ–Ω–∑—ñ–π–Ω—ñ –∫–ª—é—á—ñ –∑ —Ç–µ—Ä–º—ñ–Ω–æ–º –¥—ñ—ó
- Anti-replay –∑–∞—Ö–∏—Å—Ç

### –ê—Ç–∞–∫–∞ "Time Manipulation"

–ú–æ–∂–Ω–∞ "–∑–∞–º–æ—Ä–æ–∑–∏—Ç–∏" —á–∞—Å —Å–∏—Å—Ç–µ–º–∏:

```bash
# Linux: –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ —Ñ—ñ–∫—Å–æ–≤–∞–Ω–∏–π —á–∞—Å (–ø–æ—Ç—Ä—ñ–±–µ–Ω root)
sudo date -s "2024-01-01 12:00:00"

# –ê–±–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ libfaketime
LD_PRELOAD=/usr/lib/faketime/libfaketime.so.1 FAKETIME="2024-01-01 12:00:00" ./build/re105 Alice <serial>
```

### –ó–Ω–∞—Ö–æ–¥–∂–µ–Ω–Ω—è "—Ö–æ—Ä–æ—à–æ–≥–æ" —á–∞—Å—É

–ú–æ–∂–Ω–∞ –ø–µ—Ä–µ–±—Ä–∞—Ç–∏ –≤—Å—ñ –º–æ–∂–ª–∏–≤—ñ N (0-19):

```python
#!/usr/bin/env python3
import subprocess

def rot_n(text, n):
    result = []
    for char in text:
        if 'a' <= char <= 'z':
            result.append(chr((ord(char) - ord('a') + n) % 26 + ord('a')))
        elif 'A' <= char <= 'Z':
            result.append(chr((ord(char) - ord('A') + n) % 26 + ord('A')))
        else:
            result.append(char)
    return ''.join(result)

name = "Alice"

# –ü—Ä–æ–±—É—î–º–æ –≤—Å—ñ –º–æ–∂–ª–∏–≤—ñ –∑—Å—É–≤–∏
for n in range(20):
    serial = rot_n(name, n)
    result = subprocess.run(
        ['./build/re105', name, serial],
        capture_output=True, text=True
    )
    if "FLAG" in result.stdout:
        print(f"[+] Found! N={n}, Serial={serial}")
        print(result.stdout)
        break
    else:
        print(f"[-] N={n}, Serial={serial} - nope")
```

–û–¥–∏–Ω –∑ 20 –≤–∞—Ä—ñ–∞–Ω—Ç—ñ–≤ –ó–ê–í–ñ–î–ò —Å–ø—Ä–∞—Ü—é—î!

## üí° –ü–æ—Ä–∞–¥–∏

### –®–≤–∏–¥–∫–∏–π workflow

```bash
# –°—Ç–≤–æ—Ä—é—î–º–æ alias
alias solve='name="Alice"; serial=$(python3 solver/keygen.py "$name" 2>/dev/null | tail -1); ./build/re105 "$name" "$serial"'

# –ü—Ä–æ—Å—Ç–æ –≤–∏–∫–ª–∏–∫–∞—î–º–æ
solve
```

### Bash —Ñ—É–Ω–∫—Ü—ñ—è –∑ –≤–∏–≤–æ–¥–æ–º

```bash
function solve_task05() {
    local name="${1:-Alice}"
    local t=$(date +%s)
    local n=$((t % 20))

    echo "[*] Time: $t"
    echo "[*] N: $n"

    # ROT-N –≤ bash (—Å–ø—Ä–æ—â–µ–Ω–æ, –ø—Ä–∞—Ü—é—î —Ç—ñ–ª—å–∫–∏ –¥–ª—è ASCII)
    # –î–ª—è –ø–æ–≤–Ω–æ—Ü—ñ–Ω–Ω–æ–≥–æ —Ä—ñ—à–µ–Ω–Ω—è –∫—Ä–∞—â–µ Python

    python3 -c "
import time
def rot_n(s, n):
    r = ''
    for c in s:
        if 'a' <= c <= 'z':
            r += chr((ord(c) - ord('a') + n) % 26 + ord('a'))
        elif 'A' <= c <= 'Z':
            r += chr((ord(c) - ord('A') + n) % 26 + ord('A'))
        else:
            r += c
    return r

n = int(time.time()) % 20
serial = rot_n('$name', n)
print(f'[+] Serial: {serial}')
import subprocess
subprocess.run(['./build/re105', '$name', serial])
"
}

solve_task05 Alice
```

## üèÅ –ß–µ–∫–ª–∏—Å—Ç

- [ ] –ó—ñ–±—Ä–∞–≤ `build/re105`
- [ ] –ü—Ä–æ–∞–Ω–∞–ª—ñ–∑—É–≤–∞–≤ —á–µ—Ä–µ–∑ Ghidra (–∑–Ω–∞–π—à–æ–≤ `time()`)
- [ ] –ù–∞–ø–∏—Å–∞–≤ –∫–µ–π–≥–µ–Ω —è–∫–∏–π –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î `time()`
- [ ] –ó–≥–µ–Ω–µ—Ä—É–≤–∞–≤ —Ç–∞ –æ–¥—Ä–∞–∑—É –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–≤ —Å–µ—Ä—ñ–π–Ω–∏–∫
- [ ] –û—Ç—Ä–∏–º–∞–≤ FLAG
- [ ] (–ë–æ–Ω—É—Å) –ê–≤—Ç–æ–º–∞—Ç–∏–∑—É–≤–∞–≤ —á–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç

## üìñ –†–µ—Å—É—Ä—Å–∏

- [Unix Time](https://en.wikipedia.org/wiki/Unix_time)
- [TOTP (RFC 6238)](https://tools.ietf.org/html/rfc6238)
- [libfaketime](https://github.com/wolfcw/libfaketime)
- [Caesar Cipher](https://en.wikipedia.org/wiki/Caesar_cipher)

## üéØ –ù–∞—Å—Ç—É–ø–Ω–∏–π –∫—Ä–æ–∫

**Task 06** - UPX –ø–∞–∫—É–≤–∞–Ω–Ω—è! –Ø–∫ –∞–Ω–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –∑–∞–ø–∞–∫–æ–≤–∞–Ω—ñ –±—ñ–Ω–∞—Ä–Ω–∏–∫–∏?

---
**–°–∫–ª–∞–¥–Ω—ñ—Å—Ç—å:** ‚≠ê‚≠ê‚≠ê‚≠ê | **–ß–∞—Å:** 45-60 —Ö–≤ | **FLAG:** `FLAG{task5_ok_<name>}`
