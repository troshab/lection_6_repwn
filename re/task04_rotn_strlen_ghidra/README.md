# Task 04: ROT-N (strlen) + Ghidra

## üìã –û–ø–∏—Å –∑–∞–≤–¥–∞–Ω–Ω—è

–ó—Å—É–≤ –≤–∂–µ –ù–ï —Ñ—ñ–∫—Å–æ–≤–∞–Ω–∏–π! –¢–µ–ø–µ—Ä `N = strlen(name) % 26`. –ü–æ—Ç—Ä—ñ–±–µ–Ω **Ghidra** –¥–ª—è –¥–µ–∫–æ–º–ø—ñ–ª—è—Ü—ñ—ó —Ç–∞ —Å—Ç–∞—Ç–∏—á–Ω–æ–≥–æ –∞–Ω–∞–ª—ñ–∑—É –∫–æ–¥—É.

**–†—ñ–≤–µ–Ω—å:** ‚≠ê‚≠ê‚≠ê –°–µ—Ä–µ–¥–Ω—ñ–π | **–ö–∞—Ç–µ–≥–æ—Ä—ñ—è:** –°—Ç–∞—Ç–∏—á–Ω–∞ –¥–µ–∫–æ–º–ø—ñ–ª—è—Ü—ñ—è

## üéØ –ù–∞–≤—á–∞–ª—å–Ω–∞ –º–µ—Ç–∞

- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ Ghidra –¥–ª—è –¥–µ–∫–æ–º–ø

—ñ–ª—è—Ü—ñ—ó
- –ê–Ω–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –¥–µ–∫–æ–º–ø—ñ–ª—å–æ–≤–∞–Ω–∏–π C –∫–æ–¥
- –ó–Ω–∞—Ö–æ–¥–∏—Ç–∏ –∞–ª–≥–æ—Ä–∏—Ç–º –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó –∫–ª—é—á–∞
- –°—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ –∫–∞—Å—Ç–æ–º–Ω–∏–π –∫–µ–π–≥–µ–Ω

## üìö –©–æ –∑–º—ñ–Ω–∏–ª–æ—Å—è?

**Task 03:** `serial = ROT13(name)` - –∑–∞–≤–∂–¥–∏ –∑—Å—É–≤ 13
**Task 04:** `serial = ROT-N(name)` –¥–µ `N = strlen(name) % 26` - –∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ –¥–æ–≤–∂–∏–Ω–∏!

**–ü—Ä–∏–∫–ª–∞–¥–∏:**
- `Alice` (5 –±—É–∫–≤) ‚Üí `ROT-5` ‚Üí `Fqnhj`
- `Bob` (3 –±—É–∫–≤–∏) ‚Üí `ROT-3` ‚Üí `Ere`

## üõ†Ô∏è –ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞

### –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è Ghidra

```bash
# –°–∫–∞—á–∞—Ç–∏ –∑ –æ—Ñ—ñ—Ü—ñ–π–Ω–æ–≥–æ —Å–∞–π—Ç—É
https://ghidra-sre.org/

# –ê–±–æ —á–µ—Ä–µ–∑ –ø–∞–∫–µ—Ç–Ω–∏–π –º–µ–Ω–µ–¥–∂–µ—Ä
# Ubuntu/Debian
sudo apt install ghidra

# Arch
yay -S ghidra
```

**–ü–æ—Ç—Ä—ñ–±–Ω–æ:** Java 17+

### –ó–±—ñ—Ä–∫–∞ –±—ñ–Ω–∞—Ä–Ω–∏–∫–∞

```bash
cd task04_rotn_strlen_ghidra
./build.sh
```

## üîç –ü–æ–∫—Ä–æ–∫–æ–≤–µ —Ä—ñ—à–µ–Ω–Ω—è

### –ö—Ä–æ–∫ 1: –°–ø—Ä–æ–±–∞ —É–≥–∞–¥—É–≤–∞–Ω–Ω—è (–Ω–µ —Å–ø—Ä–∞—Ü—é—î)

```bash
./build/re104 Alice Nyvpr
# nope  (ROT13 –≤–∂–µ –Ω–µ –ø—Ä–∞—Ü—é—î!)
```

### –ö—Ä–æ–∫ 2: –ê–Ω–∞–ª—ñ–∑ —á–µ—Ä–µ–∑ GDB (–º–æ–∂–Ω–∞, –∞–ª–µ —Å–∫–ª–∞–¥–Ω–æ)

```gdb
gdb build/re104
(gdb) break strcmp
(gdb) run Alice TEST
(gdb) x/s $rdi
0x...: "Fqnhj"     # –ù–µ ROT13!
```

–ë–∞—á–∏–º–æ —ñ–Ω—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç - –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑—Ä–æ–∑—É–º—ñ—Ç–∏ –∞–ª–≥–æ—Ä–∏—Ç–º!

### –ö—Ä–æ–∫ 3: –í—ñ–¥–∫—Ä–∏—Ç–∏ —É Ghidra

1. –ó–∞–ø—É—Å—Ç—ñ—Ç—å Ghidra
2. Create New Project
3. Import File ‚Üí –≤–∏–±–µ—Ä—ñ—Ç—å `build/re104`
4. Double-click –Ω–∞ —Ñ–∞–π–ª ‚Üí Auto-analyze (Yes)

### –ö—Ä–æ–∫ 4: –ó–Ω–∞–π—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ—é main

–£ **Symbol Tree** –∑–ª—ñ–≤–∞:
```
Functions ‚Üí main
```

Double-click –Ω–∞ `main`.

### –ö—Ä–æ–∫ 5: –ê–Ω–∞–ª—ñ–∑ –¥–µ–∫–æ–º–ø—ñ–ª—å–æ–≤–∞–Ω–æ–≥–æ –∫–æ–¥—É

**Decompile –≤—ñ–∫–Ω–æ** –ø–æ–∫–∞–∂–µ —â–æ—Å—å –ø–æ–¥—ñ–±–Ω–µ:

```c
undefined8 main(int argc, char **argv)
{
  int iVar1;
  size_t nameLen;
  char *name;
  char *serial;
  void *buffer;

  if (argc != 3) {
    fprintf(stderr, "usage: %s <name> <serial>\n", *argv);
    return 1;
  }

  name = argv[1];
  serial = argv[2];
  nameLen = strlen(name);        // ‚Üê –í–ê–ñ–õ–ò–í–û!
  int N = (int)nameLen % 26;     // ‚Üê –¶–ï –§–û–†–ú–£–õ–ê –ó–°–£–í–£!

  buffer = calloc(nameLen + 1, 1);
  rot_apply(buffer, name, N);     // ‚Üê ROT-N –¥–µ N = strlen % 26

  iVar1 = strcmp(buffer, serial);
  if (iVar1 == 0) {
    printf("FLAG{task4_ok_%s}\n", name);
  } else {
    puts("nope");
  }
  free(buffer);
  return (iVar1 != 0) * 2;
}
```

### –ö—Ä–æ–∫ 6: –ó—Ä–æ–∑—É–º—ñ—Ç–∏ –∞–ª–≥–æ—Ä–∏—Ç–º

```c
N = strlen(name) % 26
serial = ROT-N(name)
```

**–î–ª—è "Alice":**
- `strlen("Alice") = 5`
- `N = 5 % 26 = 5`
- `serial = ROT-5("Alice")`

### –ö—Ä–æ–∫ 7: –ù–∞–ø–∏—Å–∞—Ç–∏ –∫–µ–π–≥–µ–Ω

**Python:**
```python
def rot_n(text, n):
    result = []
    for char in text:
        if 'a' <= char <= 'z':
            result.append(chr((ord(char) - ord('a') + n) % 26 + ord('a')))
        elif 'A' <= char <= 'Z':
            result.append(chr((ord(char) - ord('A') + n) % 26 + ord('A')))
        else:
            result.append(char)
    return ''.join(result)

name = "Alice"
n = len(name) % 26  # 5
serial = rot_n(name, n)
print(f"Name: {name}")
print(f"N: {n}")
print(f"Serial: {serial}")
```

**–í–∏–≤—ñ–¥:**
```
Name: Alice
N: 5
Serial: Fqnhj
```

### –ö—Ä–æ–∫ 8: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞

```bash
./build/re104 Alice Fqnhj
# FLAG{task4_ok_Alice}
```

üéâ **–£—Å–ø—ñ—Ö!**

## üéì Ghidra –û—Å–Ω–æ–≤–∏

### –Ü–Ω—Ç–µ—Ä—Ñ–µ–π—Å Ghidra (–¥–µ—Ç–∞–ª—å–Ω–æ –¥–ª—è –Ω–æ–≤–∞—á–∫—ñ–≤)

–ü—ñ—Å–ª—è –≤—ñ–¥–∫—Ä–∏—Ç—Ç—è —Ñ–∞–π–ª—É –≤ Ghidra –≤–∏ –ø–æ–±–∞—á–∏—Ç–µ **CodeBrowser** - –≥–æ–ª–æ–≤–Ω–µ –≤—ñ–∫–Ω–æ –∑ —Ç—Ä—å–æ–º–∞ –æ—Å–Ω–æ–≤–Ω–∏–º–∏ –ø–∞–Ω–µ–ª—è–º–∏:

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –ú–µ–Ω—é: File Edit Navigation ... ‚îÇ Tool ‚îÇ Window ‚îÇ Help     ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ Symbol Tree  ‚îÇ   Listing        ‚îÇ   Decompile                 ‚îÇ
‚îÇ (Functions)  ‚îÇ   (Assembly)     ‚îÇ   (C Code)                  ‚îÇ
‚îÇ              ‚îÇ                  ‚îÇ                             ‚îÇ
‚îÇ üìÅ Functions ‚îÇ  00400530  push  ‚îÇ  undefined8 main(int argc,  ‚îÇ
‚îÇ  ‚îú‚îÄ main     ‚îÇ  00400531  mov   ‚îÇ      char **argv)           ‚îÇ
‚îÇ  ‚îú‚îÄ rot_apply‚îÇ  00400534  sub   ‚îÇ  {                          ‚îÇ
‚îÇ  ‚îî‚îÄ strcmp   ‚îÇ  ...              ‚îÇ    if (argc != 3) {        ‚îÇ
‚îÇ              ‚îÇ                  ‚îÇ      fprintf(...);          ‚îÇ
‚îÇ üìÅ Imports   ‚îÇ                  ‚îÇ    }                        ‚îÇ
‚îÇ  ‚îú‚îÄ strlen   ‚îÇ                  ‚îÇ    ...                      ‚îÇ
‚îÇ  ‚îî‚îÄ strcmp   ‚îÇ                  ‚îÇ  }                          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –ü–∞–Ω–µ–ª—ñ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É

#### Symbol Tree (–ª—ñ–≤–∞ –ø–∞–Ω–µ–ª—å)

–¶–µ –¥–µ—Ä–µ–≤–æ —Å–∏–º–≤–æ–ª—ñ–≤ - –Ω–∞–≤—ñ–≥–∞—Ç–æ—Ä –ø–æ –≤—Å—å–æ–º—É –±—ñ–Ω–∞—Ä–Ω–∏–∫—É.

**–û—Å–Ω–æ–≤–Ω—ñ —Ä–æ–∑–¥—ñ–ª–∏:**

1. **Functions** üìÅ - –≤—Å—ñ —Ñ—É–Ω–∫—Ü—ñ—ó —É –ø—Ä–æ–≥—Ä–∞–º—ñ
   - –†–æ–∑–≥–æ—Ä–Ω—ñ—Ç—å –∫–ª–∞—Ü–Ω—É–≤—à–∏ –Ω–∞ `‚ñ∂ Functions`
   - –ü–æ–±–∞—á–∏—Ç–µ —Å–ø–∏—Å–æ–∫: `main`, `rot_apply`, `rot_shift` —Ç–æ—â–æ
   - **–ü–æ–¥–≤—ñ–π–Ω–∏–π –∫–ª—ñ–∫** –Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—ó –≤—ñ–¥–∫—Ä–∏—î —ó—ó –≤ —ñ–Ω—à–∏—Ö –ø–∞–Ω–µ–ª—è—Ö

2. **Imports** üìÅ - —Ñ—É–Ω–∫—Ü—ñ—ó –∑ –∑–æ–≤–Ω—ñ—à–Ω—ñ—Ö –±—ñ–±–ª—ñ–æ—Ç–µ–∫
   - –ù–∞–ø—Ä–∏–∫–ª–∞–¥: `strlen`, `strcmp`, `printf` –∑ libc
   - –¶–µ —Ñ—É–Ω–∫—Ü—ñ—ó, —è–∫—ñ –ø—Ä–æ–≥—Ä–∞–º–∞ –≤–∏–∫–ª–∏–∫–∞—î, –∞–ª–µ —ó—Ö –∫–æ–¥ –Ω–µ –≤ –±—ñ–Ω–∞—Ä–Ω–∏–∫—É

3. **Exports** üìÅ - —Ñ—É–Ω–∫—Ü—ñ—ó, —è–∫—ñ –µ–∫—Å–ø–æ—Ä—Ç—É—é—Ç—å—Å—è (—Ä—ñ–¥–∫–æ –¥–ª—è –ø—Ä–æ—Å—Ç–∏—Ö –ø—Ä–æ–≥—Ä–∞–º)

4. **Data** üìÅ - –≥–ª–æ–±–∞–ª—å–Ω—ñ –∑–º—ñ–Ω–Ω—ñ —Ç–∞ –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∏

**–Ø–∫ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—Ç–∏—Å—å:**
- –†–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è –ø–∞–ø–æ–∫: –∫–ª—ñ–∫ –Ω–∞ `‚ñ∂`
- –ü–µ—Ä–µ—Ö—ñ–¥ –¥–æ —Ñ—É–Ω–∫—Ü—ñ—ó: **–ø–æ–¥–≤—ñ–π–Ω–∏–π –∫–ª—ñ–∫** –Ω–∞ –Ω–∞–∑–≤—ñ
- –ü–æ—à—É–∫: `Ctrl+Shift+F` –¥–ª—è –ø–æ—à—É–∫—É —Ç–µ–∫—Å—Ç—É

#### Listing (—Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞ –ø–∞–Ω–µ–ª—å)

–ü–æ–∫–∞–∑—É—î **–∞—Å–µ–º–±–ª–µ—Ä–Ω–∏–π –∫–æ–¥** - –Ω–∏–∑—å–∫–æ—Ä—ñ–≤–Ω–µ–≤—ñ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó –ø—Ä–æ—Ü–µ—Å–æ—Ä–∞.

**–§–æ—Ä–º–∞—Ç:**
```
–ê–¥—Ä–µ—Å–∞     –Ü–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è        –ê—Ä–≥—É–º–µ–Ω—Ç–∏
00400530:  push              rbp
00400531:  mov               rbp, rsp
00400534:  sub               rsp, 0x20
```

**–ö–æ–ª–æ–Ω–∫–∏:**
- `00400530` - –∞–¥—Ä–µ—Å–∞ –≤ –ø–∞–º'—è—Ç—ñ (hex)
- `push` - —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è –∞—Å–µ–º–±–ª–µ—Ä–∞
- `rbp` - —Ä–µ–≥—ñ—Å—Ç—Ä –ø—Ä–æ—Ü–µ—Å–æ—Ä–∞

**–ù–∞–≤—ñ–≥–∞—Ü—ñ—è:**
- –ü—Ä–æ–∫—Ä—É—á—É–π—Ç–µ –º–∏—à–∫–æ—é –∞–±–æ –∫–ª–∞–≤—ñ—à–∞–º–∏ `‚Üë‚Üì`
- –ö–ª—ñ–∫ –Ω–∞ –∞–¥—Ä–µ—Å—É –ø—ñ–¥—Å–≤—ñ—Ç–∏—Ç—å –ø–æ–≤'—è–∑–∞–Ω–∏–π C –∫–æ–¥
- **–ó–µ–ª–µ–Ω–∏–π –∫–æ–ª—ñ—Ä** - –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ Ghidra

#### Decompile (–ø—Ä–∞–≤–∞ –ø–∞–Ω–µ–ª—å)

**–ù–∞–π–≤–∞–∂–ª–∏–≤—ñ—à–∞ –ø–∞–Ω–µ–ª—å!** –ü–æ–∫–∞–∑—É—î **–¥–µ–∫–æ–º–ø—ñ–ª—å–æ–≤–∞–Ω–∏–π C –∫–æ–¥** - Ghidra –Ω–∞–º–∞–≥–∞—î—Ç—å—Å—è –≤—ñ–¥–Ω–æ–≤–∏—Ç–∏ –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–∏–π –∫–æ–¥.

**–©–æ –≤–∏ —Ç—É—Ç –±–∞—á–∏—Ç–µ:**
```c
undefined8 main(int argc, char **argv)
{
  int iVar1;
  size_t nameLen;
  ...
}
```

**–í–∞–∂–ª–∏–≤–æ —Ä–æ–∑—É–º—ñ—Ç–∏:**
- –¶–µ **–ù–ï –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–∏–π –∫–æ–¥** - —Ü–µ —Ä–µ–∫–æ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è Ghidra
- –ù–∞–∑–≤–∏ –∑–º—ñ–Ω–Ω–∏—Ö –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω—ñ: `iVar1`, `local_38` (–º–æ–∂–Ω–∞ –ø–µ—Ä–µ–π–º–µ–Ω—É–≤–∞—Ç–∏)
- –¢–∏–ø–∏ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –Ω–µ–≤–∏–∑–Ω–∞—á–µ–Ω—ñ: `undefined8` –æ–∑–Ω–∞—á–∞—î "—â–æ—Å—å 8-–±–∞–π—Ç–Ω–µ"

**–ü–æ–ª—ñ–ø—à–µ–Ω–Ω—è —á–∏—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—ñ:**
1. **–ü–µ—Ä–µ–π–º–µ–Ω—É–≤–∞–Ω–Ω—è –∑–º—ñ–Ω–Ω–∏—Ö:**
   - –ü—Ä–∞–≤–∏–π –∫–ª—ñ–∫ –Ω–∞ –∑–º—ñ–Ω–Ω—É ‚Üí `Rename Variable`
   - –ù–∞–ø—Ä–∏–∫–ª–∞–¥: `local_38` ‚Üí `serial`

2. **–ó–º—ñ–Ω–∞ —Ç–∏–ø—É:**
   - –ü—Ä–∞–≤–∏–π –∫–ª—ñ–∫ ‚Üí `Retype Variable`
   - –ù–∞–ø—Ä–∏–∫–ª–∞–¥: `undefined8` ‚Üí `char *`

### –ù–∞–≤—ñ–≥–∞—Ü—ñ—è

**Symbol Tree** (–ª—ñ–≤–æ—Ä—É—á):
- `Functions` - –≤—Å—ñ —Ñ—É–Ω–∫—Ü—ñ—ó
- `Imports` - —ñ–º–ø–æ—Ä—Ç–æ–≤–∞–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó
- `Exports` - –µ–∫—Å–ø–æ—Ä—Ç–æ–≤–∞–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó
- `Data` - –≥–ª–æ–±–∞–ª—å–Ω—ñ –¥–∞–Ω—ñ

**Listing –≤—ñ–∫–Ω–æ** (—Ü–µ–Ω—Ç—Ä):
- –ê—Å–µ–º–±–ª–µ—Ä–Ω–∏–π –∫–æ–¥
- –ê–¥—Ä–µ—Å–∏ —Ç–∞ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó

**Decompile –≤—ñ–∫–Ω–æ** (–ø—Ä–∞–≤–æ—Ä—É—á):
- –î–µ–∫–æ–º–ø—ñ–ª—å–æ–≤–∞–Ω–∏–π C –∫–æ–¥
- –ù–∞–π–≤–∞–∂–ª–∏–≤—ñ—à–µ –≤—ñ–∫–Ω–æ!

### –ö–æ—Ä–∏—Å–Ω—ñ –æ–ø–µ—Ä–∞—Ü—ñ—ó

**–ü–µ—Ä–µ–π–º–µ–Ω—É–≤–∞–Ω–Ω—è –∑–º—ñ–Ω–Ω–∏—Ö:**
- Right-click –Ω–∞ –∑–º—ñ–Ω–Ω—É ‚Üí Rename Variable
- –†–æ–±–∏—Ç—å –∫–æ–¥ —á–∏—Ç–∞–±–µ–ª—å–Ω—ñ—à–∏–º

**–ü–µ—Ä–µ–≥–ª—è–¥ —Ä–µ—Ñ–µ—Ä–µ–Ω—Å—ñ–≤:**
- Right-click ‚Üí References ‚Üí Show References to ...
- –î–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —Ñ—É–Ω–∫—Ü—ñ—è/–∑–º—ñ–Ω–Ω–∞

**–ü–æ—à—É–∫ —Ä—è–¥–∫—ñ–≤:**
- Search ‚Üí For Strings
- Window ‚Üí Defined Strings

**Cross-references:**
- `CTRL+SHIFT+F` - –∑–Ω–∞–π—Ç–∏ —Ç–µ–∫—Å—Ç
- `CTRL+SHIFT+E` - –µ–∫—Å–ø–æ—Ä—Ç–∏/—ñ–º–ø–æ—Ä—Ç–∏

### Ghidra-—Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω—ñ –ø–æ–Ω—è—Ç—Ç—è –¥–ª—è –Ω–æ–≤–∞—á–∫—ñ–≤

#### –©–æ —Ç–∞–∫–µ "undefined8"?

Ghidra –Ω–µ –∑–∞–≤–∂–¥–∏ –∑–Ω–∞—î —Ç–æ—á–Ω–∏–π —Ç–∏–ø –¥–∞–Ω–∏—Ö. `undefined8` –æ–∑–Ω–∞—á–∞—î:
- `undefined` - –Ω–µ–≤—ñ–¥–æ–º–∏–π —Ç–∏–ø
- `8` - —Ä–æ–∑–º—ñ—Ä 8 –±–∞–π—Ç (64 –±—ñ—Ç–∏)

**–¢–∏–ø–æ–≤—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ—Å—Ç—ñ:**
- `undefined8` ‚Üí —á–∞—Å—Ç–æ `long`, `int64_t`, –∞–±–æ `char *` (–≤–∫–∞–∑—ñ–≤–Ω–∏–∫ –Ω–∞ 64-–±—ñ—Ç —Å–∏—Å—Ç–µ–º—ñ)
- `undefined4` ‚Üí —á–∞—Å—Ç–æ `int`, `int32_t`
- `undefined2` ‚Üí —á–∞—Å—Ç–æ `short`
- `undefined1` ‚Üí —á–∞—Å—Ç–æ `char`, `byte`

#### –©–æ —Ç–∞–∫–µ "iVar1", "local_38"?

–¶–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω—ñ –Ω–∞–∑–≤–∏ –∑–º—ñ–Ω–Ω–∏—Ö:
- `iVar1` - **i**nteger **Var**iable 1 (—Ü—ñ–ª–µ —á–∏—Å–ª–æ)
- `uVar1` - **u**nsigned variable
- `local_38` - –ª–æ–∫–∞–ª—å–Ω–∞ –∑–º—ñ–Ω–Ω–∞ –Ω–∞ —Å—Ç–µ–∫—É –∑–∞ offset 0x38
- `param_1` - –ø–µ—Ä—à–∏–π –ø–∞—Ä–∞–º–µ—Ç—Ä —Ñ—É–Ω–∫—Ü—ñ—ó

**–í–∏ –º–æ–∂–µ—Ç–µ —ó—Ö –ø–µ—Ä–µ–π–º–µ–Ω—É–≤–∞—Ç–∏!** –ü—Ä–∞–≤–∏–π –∫–ª—ñ–∫ ‚Üí Rename Variable

#### –©–æ –æ–∑–Ω–∞—á–∞—î "PTR" –≤ –∫–æ–¥—ñ?

`PTR` = Pointer (–≤–∫–∞–∑—ñ–≤–Ω–∏–∫)

```c
*PTR_strlen_00600ff8  // –í–∫–∞–∑—ñ–≤–Ω–∏–∫ –Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—é strlen
```

–¶–µ –æ–∑–Ω–∞—á–∞—î, —â–æ –∑–∞ –∞–¥—Ä–µ—Å–æ—é `0x600ff8` –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è –∞–¥—Ä–µ—Å–∞ —Ñ—É–Ω–∫—Ü—ñ—ó `strlen`.

### –ü–æ–∫—Ä–æ–∫–æ–≤–∞ —Ä–æ–±–æ—Ç–∞ –≤ Ghidra (–¥–ª—è —Ü—å–æ–≥–æ –∑–∞–≤–¥–∞–Ω–Ω—è)

**–ö—Ä–æ–∫ –∑–∞ –∫—Ä–æ–∫–æ–º —â–æ —Ä–æ–±–∏—Ç–∏ –ø—ñ—Å–ª—è –≤—ñ–¥–∫—Ä–∏—Ç—Ç—è —Ñ–∞–π–ª—É:**

1. **–ó–∞–ø—É—Å—Ç—ñ—Ç—å Ghidra:**
   ```bash
   ghidra
   ```

2. **–°—Ç–≤–æ—Ä—ñ—Ç—å –ø—Ä–æ—î–∫—Ç:**
   - File ‚Üí New Project
   - –í–∏–±–µ—Ä—ñ—Ç—å "Non-Shared Project"
   - –í–≤–µ–¥—ñ—Ç—å –Ω–∞–∑–≤—É: `re_task04`
   - –í–∏–±–µ—Ä—ñ—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—é
   - –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å `Finish`

3. **–Ü–º–ø–æ—Ä—Ç—É–π—Ç–µ —Ñ–∞–π–ª:**
   - File ‚Üí Import File
   - –í–∏–±–µ—Ä—ñ—Ç—å `build/re104`
   - –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å `OK` (Ghidra –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Ä–æ–∑–ø—ñ–∑–Ω–∞—î —Ñ–æ—Ä–º–∞—Ç)

4. **–í—ñ–¥–∫—Ä–∏–π—Ç–µ —Ñ–∞–π–ª:**
   - –ü–æ–¥–≤—ñ–π–Ω–∏–π –∫–ª—ñ–∫ –Ω–∞ `re104` –≤ —Å–ø–∏—Å–∫—É
   - –ó'—è–≤–∏—Ç—å—Å—è –ø–∏—Ç–∞–Ω–Ω—è "Would you like to analyze now?" ‚Üí **Yes**

5. **–î–æ—á–µ–∫–∞–π—Ç–µ—Å—å –∞–Ω–∞–ª—ñ–∑—É:**
   - –ë—É–¥–µ –≤–∏–¥–Ω–æ –ø—Ä–æ–≥—Ä–µ—Å-–±–∞—Ä: "Auto Analysis"
   - –ó–∞—á–µ–∫–∞–π—Ç–µ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è (5-30 —Å–µ–∫—É–Ω–¥)

6. **–ó–Ω–∞–π–¥—ñ—Ç—å main:**
   - –£ –ª—ñ–≤—ñ–π –ø–∞–Ω–µ–ª—ñ Symbol Tree
   - –†–æ–∑–≥–æ—Ä–Ω—ñ—Ç—å `Functions` (–∫–ª—ñ–∫ –Ω–∞ `‚ñ∂`)
   - –ü—Ä–æ–∫—Ä—É—Ç—ñ—Ç—å –≤–Ω–∏–∑ –¥–æ `main`
   - **–ü–æ–¥–≤—ñ–π–Ω–∏–π –∫–ª—ñ–∫** –Ω–∞ `main`

7. **–ß–∏—Ç–∞–π—Ç–µ –¥–µ–∫–æ–º–ø—ñ–ª—å–æ–≤–∞–Ω–∏–π –∫–æ–¥:**
   - –ü—Ä–∞–≤–∞ –ø–∞–Ω–µ–ª—å (Decompile) –ø–æ–∫–∞–∂–µ C –∫–æ–¥
   - –®—É–∫–∞–π—Ç–µ –≤–∏–∫–ª–∏–∫–∏ `strlen`, `calloc`, `rot_apply`
   - –ó–Ω–∞–π–¥—ñ—Ç—å —Ä—è–¥–æ–∫: `int N = (int)nameLen % 26;`

8. **–ü—Ä–æ–∞–Ω–∞–ª—ñ–∑—É–π—Ç–µ:**
   - –¶–µ —ñ —î —Ñ–æ—Ä–º—É–ª–∞ –æ–±—á–∏—Å–ª–µ–Ω–Ω—è –∑—Å—É–≤—É!
   - `N = strlen(name) % 26`

## üí° –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ñ –º–µ—Ç–æ–¥–∏

### IDA Free

–ë–µ–∑–∫–æ—à—Ç–æ–≤–Ω–∞ –≤–µ—Ä—Å—ñ—è IDA Pro —Ç–∞–∫–æ–∂ –º–æ–∂–µ –¥–µ–∫–æ–º–ø—ñ–ª—é–≤–∞—Ç–∏.

### radare2 + Ghidra

```bash
r2 -A build/re104
[0x00400530]> pdf @ main   # –î–∏–∑–∞—Å–µ–º–±–ª—é–≤–∞–Ω–Ω—è main
[0x00400530]> pdg @ main   # –î–µ–∫–æ–º–ø—ñ–ª—è—Ü—ñ—è (–ø–æ—Ç—Ä—ñ–±–µ–Ω r2ghidra plugin)
```

### objdump + —á–∏—Ç–∞–Ω–Ω—è –∞—Å–µ–º–±–ª–µ—Ä–∞

```bash
objdump -d -M intel build/re104 | grep -A 50 "<main>:"
```

–ó–Ω–∞–π–¥–µ–º–æ –≤–∏–∫–ª–∏–∫ `strlen` —Ç–∞ –ø–æ–¥–∞–ª—å—à–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É.

## üßÆ ROT-N –∫–µ–π–≥–µ–Ω (–ø–æ–≤–Ω–∞ –≤–µ—Ä—Å—ñ—è)

```python
#!/usr/bin/env python3

def rot_n(text, n):
    """–ó–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏ ROT-N —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è"""
    result = []
    for char in text:
        if 'a' <= char <= 'z':
            shifted = (ord(char) - ord('a') + n) % 26
            result.append(chr(shifted + ord('a')))
        elif 'A' <= char <= 'Z':
            shifted = (ord(char) - ord('A') + n) % 26
            result.append(chr(shifted + ord('A')))
        else:
            result.append(char)
    return ''.join(result)

def generate_serial(name):
    """–ì–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ —Å–µ—Ä—ñ–π–Ω–∏–∫ –¥–ª—è task04"""
    n = len(name) % 26
    serial = rot_n(name, n)
    return serial

if __name__ == "__main__":
    import sys

    if len(sys.argv) != 2:
        print(f"Usage: {sys.argv[0]} <name>")
        sys.exit(1)

    name = sys.argv[1]
    n = len(name) % 26
    serial = generate_serial(name)

    print(f"[+] Name: {name}")
    print(f"[+] Length: {len(name)}")
    print(f"[+] N (shift): {n}")
    print(f"[+] Serial: {serial}")
    print()
    print(f"[*] Run: ./build/re104 {name} {serial}")
```

**–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è:**
```bash
python3 keygen.py Alice
# [+] Serial: Fqnhj
```

## üèÅ –ß–µ–∫–ª–∏—Å—Ç

- [ ] –í—Å—Ç–∞–Ω–æ–≤–∏–≤ Ghidra
- [ ] –í—ñ–¥–∫—Ä–∏–≤ `build/re104` —É Ghidra
- [ ] –ü—Ä–æ–∞–Ω–∞–ª—ñ–∑—É–≤–∞–≤ —Ñ—É–Ω–∫—Ü—ñ—é `main`
- [ ] –ó–Ω–∞–π—à–æ–≤ —Ñ–æ—Ä–º—É–ª—É `N = strlen(name) % 26`
- [ ] –ù–∞–ø–∏—Å–∞–≤ –∫–µ–π–≥–µ–Ω
- [ ] –ó–≥–µ–Ω–µ—Ä—É–≤–∞–≤ —Å–µ—Ä—ñ–π–Ω–∏–∫
- [ ] –û—Ç—Ä–∏–º–∞–≤ FLAG

## üìñ –†–µ—Å—É—Ä—Å–∏

- [Ghidra Official](https://ghidra-sre.org/)
- [Ghidra Cheat Sheet](https://ghidra-sre.org/CheatSheet.html)
- [Ghidra Book](https://nostarch.com/GhidraBook)
- [Ghidra Courses](https://hackaday.io/project/172292-introduction-to-reverse-engineering-with-ghidra)

## üéØ –ù–∞—Å—Ç—É–ø–Ω–∏–π –∫—Ä–æ–∫

**Task 05** - `N = time() % 20`! –ó—Å—É–≤ –∑–º—ñ–Ω—é—î—Ç—å—Å—è –∫–æ–∂–Ω–æ—ó —Å–µ–∫—É–Ω–¥–∏!

---
**–°–∫–ª–∞–¥–Ω—ñ—Å—Ç—å:** ‚≠ê‚≠ê‚≠ê | **–ß–∞—Å:** 45-60 —Ö–≤ | **FLAG:** `FLAG{task4_ok_<name>}`
