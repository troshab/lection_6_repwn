# Task 06: UPX Packer (–ü–∞–∫—É–≤–∞–Ω–Ω—è –±—ñ–Ω–∞—Ä–Ω–∏–∫—ñ–≤)

## üìã –û–ø–∏—Å –∑–∞–≤–¥–∞–Ω–Ω—è

–ë—ñ–Ω–∞—Ä–Ω–∏–∫ **–∑–∞–ø–∞–∫–æ–≤–∞–Ω–∏–π** –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é UPX! –ó–≤–∏—á–∞–π–Ω—ñ –º–µ—Ç–æ–¥–∏ –∞–Ω–∞–ª—ñ–∑—É –Ω–µ —Å–ø—Ä–∞—Ü—é—é—Ç—å. –ù–∞–≤—á—ñ—Ç—å—Å—è —Ä–æ–∑–ø—ñ–∑–Ω–∞–≤–∞—Ç–∏ —Ç–∞ —Ä–æ–∑–ø–∞–∫–æ–≤—É–≤–∞—Ç–∏ —É–ø–∞–∫–æ–≤–∞–Ω—ñ —Ñ–∞–π–ª–∏.

**–†—ñ–≤–µ–Ω—å:** ‚≠ê‚≠ê‚≠ê –°–µ—Ä–µ–¥–Ω—ñ–π | **–ö–∞—Ç–µ–≥–æ—Ä—ñ—è:** Packing, Unpacking, Obfuscation

## üéØ –ù–∞–≤—á–∞–ª—å–Ω–∞ –º–µ—Ç–∞

- –†–æ–∑–ø—ñ–∑–Ω–∞–≤–∞—Ç–∏ –∑–∞–ø–∞–∫–æ–≤–∞–Ω—ñ –±—ñ–Ω–∞—Ä–Ω–∏–∫–∏
- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ UPX –¥–ª—è —Ä–æ–∑–ø–∞–∫—É–≤–∞–Ω–Ω—è
- –†–æ–∑—É–º—ñ—Ç–∏ —á–æ–º—É –ø–∞–∫—É–≤–∞–Ω–Ω—è —É—Å–∫–ª–∞–¥–Ω—é—î –∞–Ω–∞–ª—ñ–∑
- –ê–Ω–∞–ª—ñ–∑—É–≤–∞—Ç–∏ —Ä–æ–∑–ø–∞–∫–æ–≤–∞–Ω—ñ —Ñ–∞–π–ª–∏

## üìö –©–æ —Ç–∞–∫–µ UPX?

**UPX (Ultimate Packer for eXecutables)** - –±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–∏–π –ø–∞–∫—É–≤–∞–ª—å–Ω–∏–∫ –≤–∏–∫–æ–Ω—É–≤–∞–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤.

**–©–æ —Ä–æ–±–∏—Ç—å:**
- –°—Ç–∏—Å–∫–∞—î –±—ñ–Ω–∞—Ä–Ω–∏–∫ (50-70% –∑–º–µ–Ω—à–µ–Ω–Ω—è —Ä–æ–∑–º—ñ—Ä—É)
- –î–æ–¥–∞—î —Ä–æ–∑–ø–∞–∫–æ–≤—É–≤–∞—á (stub)
- –ü—Ä–∏ –∑–∞–ø—É—Å–∫—É: —Ä–æ–∑–ø–∞–∫–æ–≤—É—î –≤ –ø–∞–º'—è—Ç—å ‚Üí –≤–∏–∫–æ–Ω—É—î

**–ß–æ–º—É –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è:**
- ‚úÖ –ó–∞–∫–æ–Ω–Ω–æ: –∑–º–µ–Ω—à–µ–Ω–Ω—è —Ä–æ–∑–º—ñ—Ä—É —Ñ–∞–π–ª—ñ–≤
- ‚ùå –ú–∞–ª–≤–∞—Ä: –ø—Ä–∏—Ö–æ–≤—É–≤–∞–Ω–Ω—è –≤—ñ–¥ –∞–Ω—Ç–∏–≤—ñ—Ä—É—Å—ñ–≤
- ‚ùå –ö—Ä–µ–∫—ñ–Ω–≥: —É—Å–∫–ª–∞–¥–Ω–µ–Ω–Ω—è —Ä–µ–≤–µ—Ä—Å—É

## üõ†Ô∏è –ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞

### –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è UPX

```bash
# Ubuntu/Debian
sudo apt install upx-ucl

# Fedora
sudo dnf install upx

# Arch
sudo pacman -S upx

# Manual download
https://github.com/upx/upx/releases
```

### –ó–±—ñ—Ä–∫–∞ —Ç–∞ –ø–∞–∫—É–≤–∞–Ω–Ω—è

```bash
cd task06_upx_packer
./build.sh
# –°–∫—Ä–∏–ø—Ç –∑–∞–ø—Ä–æ–ø–æ–Ω—É—î –∑–∞–ø–∞–∫—É–≤–∞—Ç–∏ —á–µ—Ä–µ–∑ UPX

# –ê–±–æ –≤—Ä—É—á–Ω—É:
make clean && make
upx -9 build/re106 -o build/re106_packed
```

## üîç –ü–æ–∫—Ä–æ–∫–æ–≤–µ —Ä—ñ—à–µ–Ω–Ω—è

### –ö—Ä–æ–∫ 1: –†–æ–∑–ø—ñ–∑–Ω–∞–≤–∞–Ω–Ω—è —É–ø–∞–∫–æ–≤–∞–Ω–æ–≥–æ —Ñ–∞–π–ª—É

```bash
file build/re106_packed
```

**–í–∏–≤—ñ–¥:**
```
build/re106_packed: ELF 64-bit LSB executable, x86-64, version 1 (SYSV),
dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, for GNU/Linux 3.2.0, stripped
```

Hmm, –≤–∏–≥–ª—è–¥–∞—î –Ω–æ—Ä–º–∞–ª—å–Ω–æ... –ê–ª–µ —Å–ø—Ä–æ–±—É—î–º–æ `strings`:

```bash
strings -a build/re106_packed | head -n 20
```

**–í–∏–≤—ñ–¥:**
```
UPX!
$Info: This file is packed with the UPX executable packer http://upx.sf.net $
...
```

**–ê–≥–∞!** –ë–∞—á–∏–º–æ `UPX!` - —Ñ–∞–π–ª —É–ø–∞–∫–æ–≤–∞–Ω–∏–π!

### –ö—Ä–æ–∫ 2: –ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è —Ä–æ–∑–º—ñ—Ä—ñ–≤

```bash
ls -lh build/re106 build/re106_packed
```

**–í–∏–≤—ñ–¥:**
```
-rwxr-xr-x 1 user user 16K build/re106
-rwxr-xr-x 1 user user 7.2K build/re106_packed
```

–£–ø–∞–∫–æ–≤–∞–Ω–∏–π —Ñ–∞–π–ª –Ω–∞ 55% –º–µ–Ω—à–∏–π!

### –ö—Ä–æ–∫ 3: –°–ø—Ä–æ–±–∞ –∞–Ω–∞–ª—ñ–∑—É –ë–ï–ó —Ä–æ–∑–ø–∞–∫—É–≤–∞–Ω–Ω—è (FAIL)

```bash
# Strings –Ω–µ –ø–æ–∫–∞–∂–µ –∫–æ—Ä–∏—Å–Ω–æ–≥–æ
strings -a build/re106_packed | grep -i serial
# –ú–∞–π–∂–µ –Ω—ñ—á–æ–≥–æ –∫–æ—Ä–∏—Å–Ω–æ–≥–æ...

# Ghidra –ø–æ–∫–∞–∑—É—î stub –∫–æ–¥, –Ω–µ –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–∏–π
# IDA –ø–æ–∫–∞–∑—É—î —Ä–æ–∑–ø–∞–∫–æ–≤—É–≤–∞—á, –Ω–µ –ª–æ–≥—ñ–∫—É –ø—Ä–æ–≥—Ä–∞–º–∏
```

### –ö—Ä–æ–∫ 4: –†–æ–∑–ø–∞–∫—É–≤–∞–Ω–Ω—è —á–µ—Ä–µ–∑ UPX

```bash
upx -d build/re106_packed -o build/re106_unpacked
```

**–í–∏–≤—ñ–¥:**
```
                       Ultimate Packer for eXecutables
                          Copyright (C) 1996 - 2023
UPX 4.2.1       Markus Oberhumer, Laszlo Molnar & John Reiser    Nov 1st 2023

        File size         Ratio      Format      Name
   --------------------   ------   -----------   ---------------------
     16384 <-      7368   44.97%   linux/amd64   re106_unpacked

Unpacked 1 file.
```

### –ö—Ä–æ–∫ 5: –ê–Ω–∞–ª—ñ–∑ —Ä–æ–∑–ø–∞–∫–æ–≤–∞–Ω–æ–≥–æ —Ñ–∞–π–ª—É

–¢–µ–ø–µ—Ä —Ñ–∞–π–ª —Ä–æ–∑–ø–∞–∫–æ–≤–∞–Ω–∏–π - –º–æ–∂–Ω–∞ –∞–Ω–∞–ª—ñ–∑—É–≤–∞—Ç–∏ —è–∫ –∑–≤–∏—á–∞–π–Ω–æ!

```bash
strings -a build/re106_unpacked | grep -i "KEY\|SERIAL"
```

**–í–∏–≤—ñ–¥:**
```
PACKED-KEY-9000
```

**–ó–Ω–∞–π—à–ª–∏ –∫–ª—é—á!**

### –ö—Ä–æ–∫ 6: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞

```bash
./build/re106_unpacked Alice PACKED-KEY-9000
# FLAG{task6_ok_Alice}
```

üéâ **–£—Å–ø—ñ—Ö!**

**–í–∞–∂–ª–∏–≤–æ:** –£–ø–∞–∫–æ–≤–∞–Ω–∏–π —Ñ–∞–π–ª (`re106_packed`) —Ç–∞–∫–æ–∂ –ø—Ä–∞—Ü—é—î:

```bash
./build/re106_packed Alice PACKED-KEY-9000
# FLAG{task6_ok_Alice}
```

–ê–ª–µ –∞–Ω–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –ø–æ—Ç—Ä—ñ–±–Ω–æ **—Ä–æ–∑–ø–∞–∫–æ–≤–∞–Ω–∏–π**!

## üéì –î–µ—Ç–∞–ª—å–Ω–∏–π –∞–Ω–∞–ª—ñ–∑ UPX

### –Ø–∫ –ø—Ä–∞—Ü—é—î UPX

```
–û—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–∏–π —Ñ–∞–π–ª ‚Üí –°—Ç–∏—Å–∫–∞–Ω–Ω—è ‚Üí –î–æ–¥–∞–≤–∞–Ω–Ω—è stub ‚Üí –£–ø–∞–∫–æ–≤–∞–Ω–∏–π —Ñ–∞–π–ª
     (re106)                                        (re106_packed)

–ü—Ä–∏ –∑–∞–ø—É—Å–∫—É:
1. Stub —Ä–æ–∑–ø–∞–∫–æ–≤—É—î –≤ –ø–∞–º'—è—Ç—å
2. –ü–µ—Ä–µ–¥–∞—î —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–æ–º—É –∫–æ–¥—É
3. –ü—Ä–æ–≥—Ä–∞–º–∞ –ø—Ä–∞—Ü—é—î –Ω–æ—Ä–º–∞–ª—å–Ω–æ
```

### –í–∏—è–≤–ª–µ–Ω–Ω—è UPX

#### –ú–µ—Ç–æ–¥ 1: strings

```bash
strings -a binary | grep -i upx
```

#### –ú–µ—Ç–æ–¥ 2: –°–µ–∫—Ü—ñ—ó –∑ –Ω–∞–∑–≤–æ—é UPX

```bash
readelf -S binary | grep UPX
```

**–í–∏–≤—ñ–¥:**
```
[13] UPX0            PROGBITS  ...
[14] UPX1            PROGBITS  ...
```

#### –ú–µ—Ç–æ–¥ 3: Entropy –∞–Ω–∞–ª—ñ–∑

–£–ø–∞–∫–æ–≤–∞–Ω—ñ —Ñ–∞–π–ª–∏ –º–∞—é—Ç—å –≤–∏—Å–æ–∫—É –µ–Ω—Ç—Ä–æ–ø—ñ—é (–≤–∏–≥–ª—è–¥–∞—é—Ç—å —è–∫ –≤–∏–ø–∞–¥–∫–æ–≤—ñ –¥–∞–Ω—ñ).

```bash
# –ó –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º binwalk
binwalk -E binary

# –ó –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º detect-it-easy
die binary
```

### UPX –æ–ø—Ü—ñ—ó

```bash
# –ü–∞–∫—É–≤–∞–Ω–Ω—è –∑ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∏–º —Å—Ç–∏—Å–Ω–µ–Ω–Ω—è–º
upx -9 binary

# –ü–∞–∫—É–≤–∞–Ω–Ω—è –∑ –Ω–∞–π–∫—Ä–∞—â–∏–º stis–Ω–µ–Ω–Ω—è–º (–ø–æ–≤—ñ–ª—å–Ω—ñ—à–µ)
upx --best --ultra-brute binary

# –†–æ–∑–ø–∞–∫—É–≤–∞–Ω–Ω—è
upx -d packed_binary

# –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è (–Ω–µ –∑–º—ñ–Ω—é—î —Ñ–∞–π–ª)
upx -t binary

# –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ —É–ø–∞–∫–æ–≤–∞–Ω–∏–π —Ñ–∞–π–ª
upx -l packed_binary
```

### –ó–∞—Ö–∏—Å—Ç –≤—ñ–¥ —Ä–æ–∑–ø–∞–∫—É–≤–∞–Ω–Ω—è

UPX –ø—ñ–¥—Ç—Ä–∏–º—É—î –æ–ø—Ü—ñ—é `--no-backup` —Ç–∞ –º–æ–¥–∏—Ñ—ñ–∫–∞—Ü—ñ—é –∑–∞–≥–æ–ª–æ–≤–∫—ñ–≤:

```bash
# –ü–∞–∫—É–≤–∞–Ω–Ω—è –∑ –º–æ–¥–∏—Ñ—ñ–∫–æ–≤–∞–Ω–∏–º –∑–∞–≥–æ–ª–æ–≤–∫–æ–º
upx -9 --no-backup binary
# –ü–æ—Ç—ñ–º hex-—Ä–µ–¥–∞–∫—Ç–æ—Ä–æ–º –∑–º—ñ–Ω–∏—Ç–∏ "UPX!" —Å–∏–≥–Ω–∞—Ç—É—Ä—É

# –¢–µ–ø–µ—Ä upx -d –Ω–µ —Å–ø—Ä–∞—Ü—é—î –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ!
```

**–û–±—Ö—ñ–¥:** –í—Ä—É—á–Ω—É –≤—ñ–¥–Ω–æ–≤–∏—Ç–∏ —Å–∏–≥–Ω–∞—Ç—É—Ä—É –∞–±–æ —Ä–æ–∑–ø–∞–∫—É–≤–∞—Ç–∏ –≤ –ø–∞–º'—è—Ç—ñ —á–µ—Ä–µ–∑ –¥–µ–±–∞–≥–µ—Ä.

## üí° –Ü–Ω—à—ñ –ø–∞–∫—É–≤–∞–ª—å–Ω–∏–∫–∏

### Popular packers:

1. **UPX** (open-source, –Ω–∞–π–ø–æ–ø—É–ª—è—Ä–Ω—ñ—à–∏–π)
2. **Themida** (–∫–æ–º–µ—Ä—Ü—ñ–π–Ω–∏–π, –¥—É–∂–µ —Å–∫–ª–∞–¥–Ω–∏–π)
3. **VMProtect** (–≤—ñ—Ä—Ç—É–∞–ª—ñ–∑–∞—Ü—ñ—è –∫–æ–¥—É)
4. **ASPack** (–¥–ª—è Windows)
5. **PECompact** (–¥–ª—è Windows)

### –£–Ω—ñ–≤–µ—Ä—Å–∞–ª—å–Ω—ñ —Ä–æ–∑–ø–∞–∫–æ–≤—É–≤–∞—á—ñ:

- **Detect It Easy (DiE)** - –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è –ø–∞–∫—É–≤–∞–ª—å–Ω–∏–∫–∞
- **PE Explorer** - –∞–Ω–∞–ª—ñ–∑ PE —Ñ–∞–π–ª—ñ–≤
- **CFF Explorer** - –¥–µ—Ç–∞–ª—å–Ω–∏–π –∞–Ω–∞–ª—ñ–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä

## üêõ Advanced Troubleshooting (–ü—Ä–æ—Å—É–Ω—É—Ç–µ)

### UPX –≤–∏–¥–∞–ª–∏–≤ —Å–∏–≥–Ω–∞—Ç—É—Ä—É (modified UPX)

–Ü–Ω–æ–¥—ñ –º–∞–ª–≤–∞—Ä –∞–≤—Ç–æ—Ä–∏ –º–æ–¥–∏—Ñ—ñ–∫—É—é—Ç—å UPX, –≤–∏–¥–∞–ª—è—é—á–∏ —Å–∏–≥–Ω–∞—Ç—É—Ä—É "UPX!".

**–í–∏—è–≤–ª–µ–Ω–Ω—è:**
```bash
# Strings –Ω–µ –ø–æ–∫–∞–∑—É—î "UPX"
strings -a binary | grep -i upx
# (–ø–æ—Ä–æ–∂–Ω—ñ–π –≤–∏–≤—ñ–¥)

# –ê–ª–µ –µ–Ω—Ç—Ä–æ–ø—ñ—è –≤–∏—Å–æ–∫–∞ (—Å—Ç–∏—Å–Ω–µ–Ω–∏–π —Ñ–∞–π–ª)
# –°–µ–∫—Ü—ñ—ó –º–∞—é—Ç—å –ø—ñ–¥–æ–∑—Ä—ñ–ª—ñ –Ω–∞–∑–≤–∏
readelf -S binary
```

**–†—ñ—à–µ–Ω–Ω—è 1: –°–ø—Ä–æ–±–∞ —Ä–æ–∑–ø–∞–∫—É–≤–∞–Ω–Ω—è –≤—Å–µ –æ–¥–Ω–æ:**
```bash
upx -d binary
# –ú–æ–∂–µ —Å–ø—Ä–∞—Ü—é–≤–∞—Ç–∏ —è–∫—â–æ –∑–º—ñ–Ω–µ–Ω–∞ —Ç—ñ–ª—å–∫–∏ —Å–∏–≥–Ω–∞—Ç—É—Ä–∞
```

**–†—ñ—à–µ–Ω–Ω—è 2: –í—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è —Å–∏–≥–Ω–∞—Ç—É—Ä–∏:**
```bash
# –ó–Ω–∞–π—Ç–∏ offset –¥–µ –º–∞—î –±—É—Ç–∏ "UPX!"
xxd binary | grep -i "00.*00.*00"

# –í—ñ–¥—Ä–µ–¥–∞–≥—É–≤–∞—Ç–∏ hex —Ä–µ–¥–∞–∫—Ç–æ—Ä–æ–º (ghex, hexedit)
# –î–æ–¥–∞—Ç–∏ –±–∞–π—Ç–∏: 55 50 58 21 (hex –¥–ª—è "UPX!")

# –°–ø—Ä–æ–±—É–≤–∞—Ç–∏ —Ä–æ–∑–ø–∞–∫—É–≤–∞—Ç–∏
upx -d binary
```

**–†—ñ—à–µ–Ω–Ω—è 3: –†–æ–∑–ø–∞–∫—É–≤–∞–Ω–Ω—è –≤ –ø–∞–º'—è—Ç—ñ:**
```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç–∏ —á–µ—Ä–µ–∑ GDB
gdb binary

# –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ breakpoint –ø—ñ—Å–ª—è —Ä–æ–∑–ø–∞–∫—É–≤–∞–Ω–Ω—è
# (—à—É–∫–∞—Ç–∏ –≤–∏–∫–ª–∏–∫ jmp –¥–æ –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–æ–≥–æ entry point)
break *0x400000  # –ü—Ä–∏–±–ª–∏–∑–Ω–∏–π entry point

# –î–∞–º–ø–Ω—É—Ç–∏ —Ä–æ–∑–ø–∞–∫–æ–≤–∞–Ω–∏–π –∫–æ–¥ –∑ –ø–∞–º'—è—Ç—ñ
dump memory unpacked.bin 0x400000 0x500000
```

### –ü–æ–º–∏–ª–∫–∞: "NotPackedException: not packed by UPX"

**–ü—Ä–∏—á–∏–Ω–∞:**
- –§–∞–π–ª –Ω–µ —É–ø–∞–∫–æ–≤–∞–Ω–∏–π UPX
- –ê–±–æ —Å–∏–≥–Ω–∞—Ç—É—Ä–∞ –ø–æ—à–∫–æ–¥–∂–µ–Ω–∞
- –ê–±–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∞ –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞ –≤–µ—Ä—Å—ñ—è UPX

**–î—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:**
```bash
# –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ entropy
binwalk -E binary
# –£–ø–∞–∫–æ–≤–∞–Ω–∏–π —Ñ–∞–π–ª –º–∞—î –≤–∏—Å–æ–∫—É –µ–Ω—Ç—Ä–æ–ø—ñ—é (–±–ª–∏–∑—å–∫–æ 7-8)

# –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å–µ–∫—Ü—ñ–π
readelf -S binary | head -20
# –®—É–∫–∞—î–º–æ —Å–µ–∫—Ü—ñ—ó UPX0, UPX1, —Ç–æ—â–æ
```

**–†—ñ—à–µ–Ω–Ω—è:**
- –Ø–∫—â–æ —î —Å–µ–∫—Ü—ñ—ó UPXn - —Å–ø—Ä–æ–±—É–π—Ç–µ —Å—Ç–∞—Ä—ñ—à—É –≤–µ—Ä—Å—ñ—é UPX
- –°–ø—Ä–æ–±—É–π—Ç–µ —Ä—ñ–∑–Ω—ñ —Ñ–ª–∞–≥–∏: `upx -d --force binary`

### UPX —Ä–æ–∑–ø–∞–∫—É–≤–∞–≤, –∞–ª–µ –±—ñ–Ω–∞—Ä–Ω–∏–∫ –Ω–µ –∑–∞–ø—É—Å–∫–∞—î—Ç—å—Å—è

**–ü—Ä–∏—á–∏–Ω–∞:** UPX —ñ–Ω–æ–¥—ñ –ø—Å—É—î –±—ñ–Ω–∞—Ä–Ω–∏–∫ –ø—Ä–∏ —Ä–æ–∑–ø–∞–∫—É–≤–∞–Ω–Ω—ñ

**–î—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:**
```bash
# –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –≤–∞–ª—ñ–¥–Ω–æ—Å—Ç—ñ ELF
file unpacked_binary

# –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ integrity
readelf -h unpacked_binary

# –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ strace –¥–ª—è –¥–µ—Ç–∞–ª–µ–π
strace ./unpacked_binary
```

**–†—ñ—à–µ–Ω–Ω—è:**
```bash
# –°–ø—Ä–æ–±—É–≤–∞—Ç–∏ -k (keep broken output)
upx -d --keep-broken binary -o unpacked

# –ê–±–æ -f (force overwrite)
upx -d -f binary
```

### –í–∏–∑–Ω–∞—á–µ–Ω–Ω—è –º–æ–¥–∏—Ñ—ñ–∫–æ–≤–∞–Ω–æ–≥–æ UPX

**–Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ –¥–ª—è –≤–∏—è–≤–ª–µ–Ω–Ω—è:**

1. **Detect It Easy (DiE):**
```bash
die binary
# –ü–æ–∫–∞–∂–µ: "UPX (modified)" —è–∫—â–æ –º–æ–¥–∏—Ñ—ñ–∫–æ–≤–∞–Ω–∏–π
```

2. **PEiD signatures (–¥–ª—è Windows, –∞–ª–µ –∫–æ–Ω—Ü–µ–ø—Ü—ñ—è —Ç–∞ —Å–∞–º–∞):**
- –°—Ç–≤–æ—Ä–∏—Ç–∏ –∫–∞—Å—Ç–æ–º–Ω—É —Å–∏–≥–Ω–∞—Ç—É—Ä—É
- –ü–æ—Ä—ñ–≤–Ω—è—Ç–∏ –∑ known good UPX

3. **Manual analysis:**
```bash
# –ü–æ—Ä—ñ–≤–Ω—è—Ç–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∑ –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–∏–º UPX
hexdump -C original_upx.packed > orig.hex
hexdump -C modified_upx.packed > modi.hex
diff orig.hex modi.hex
```

### –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∏ —è–∫—â–æ UPX –Ω–µ –ø—Ä–∞—Ü—é—î

**–Ø–∫—â–æ UPX —Ä–æ–∑–ø–∞–∫—É–≤–∞–Ω–Ω—è –Ω–µ —Å–ø—Ä–∞—Ü—å–æ–≤—É—î:**

1. **Generic unpacker:**
```bash
# –í–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ PIN (dynamic instrumentation)
# –î–∞–º–ø–Ω—É—Ç–∏ –ø–∞–º'—è—Ç—å –ø—ñ—Å–ª—è —Ä–æ–∑–ø–∞–∫—É–≤–∞–Ω–Ω—è
```

2. **–†—É—á–Ω–µ —Ä–æ–∑–ø–∞–∫—É–≤–∞–Ω–Ω—è —á–µ—Ä–µ–∑ GDB:**
```bash
gdb binary
break _start
run
# –ü—Ä–æ–∫—Ä—É—Ç–∏—Ç–∏ –¥–æ –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–æ–≥–æ –∫–æ–¥—É
# –î–∞–º–ø–Ω—É—Ç–∏ memory
```

3. **Automated unpackers:**
- **unipacker** (Python tool for automatic unpacking)
- **de4dot** (–¥–ª—è .NET)
- **RDG Packer Detector**

## üèÅ –ß–µ–∫–ª–∏—Å—Ç

- [ ] –í—Å—Ç–∞–Ω–æ–≤–∏–≤ UPX
- [ ] –ó—ñ–±—Ä–∞–≤ `build/re106`
- [ ] –ó–∞–ø–∞–∫—É–≤–∞–≤ —á–µ—Ä–µ–∑ `upx -9`
- [ ] –†–æ–∑–ø—ñ–∑–Ω–∞–≤ —É–ø–∞–∫–æ–≤–∞–Ω–∏–π —Ñ–∞–π–ª (`strings | grep UPX`)
- [ ] –†–æ–∑–ø–∞–∫—É–≤–∞–≤ —á–µ—Ä–µ–∑ `upx -d`
- [ ] –ü—Ä–æ–∞–Ω–∞–ª—ñ–∑—É–≤–∞–≤ —Ä–æ–∑–ø–∞–∫–æ–≤–∞–Ω–∏–π —Ñ–∞–π–ª
- [ ] –ó–Ω–∞–π—à–æ–≤ –∫–ª—é—á `PACKED-KEY-9000`
- [ ] –û—Ç—Ä–∏–º–∞–≤ FLAG
- [ ] (–ë–æ–Ω—É—Å) –ó—Ä–æ–∑—É–º—ñ–≤ —è–∫ –≤–∏—è–≤–∏—Ç–∏ modified UPX

## üìñ –†–µ—Å—É—Ä—Å–∏

- [UPX Official](https://upx.github.io/)
- [UPX GitHub](https://github.com/upx/upx)
- [Detect It Easy](https://github.com/horsicq/Detect-It-Easy)
- [Unpacking Tutorial](https://www.youtube.com/watch?v=X3giMAGMf8E)

## üéØ –ù–∞—Å—Ç—É–ø–Ω–∏–π –∫—Ä–æ–∫

**Task 07** - –ü—Ä–∏—Ö–æ–≤–∞–Ω–∏–π HTTP —Å–µ—Ä–≤–µ—Ä! –ü–æ—Ç—Ä—ñ–±–µ–Ω `strace` –¥–ª—è –≤–∏—è–≤–ª–µ–Ω–Ω—è –º–µ—Ä–µ–∂–µ–≤–æ—ó –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ!

---
**–°–∫–ª–∞–¥–Ω—ñ—Å—Ç—å:** ‚≠ê‚≠ê‚≠ê | **–ß–∞—Å:** 30-45 —Ö–≤ | **FLAG:** `FLAG{task6_ok_<name>}`
